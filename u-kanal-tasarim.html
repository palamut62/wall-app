<!DOCTYPE html>
<html lang="tr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Betonarme U-Kanal TasarÄ±m UygulamasÄ±</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            padding: 20px;
            min-height: 100vh;
        }

        .container {
            max-width: 1400px;
            margin: 0 auto;
            background: white;
            border-radius: 20px;
            box-shadow: 0 20px 60px rgba(0,0,0,0.3);
            overflow: hidden;
        }

        .header {
            background: linear-gradient(135deg, #1e3c72 0%, #2a5298 100%);
            color: white;
            padding: 30px;
            text-align: center;
        }

        .header h1 {
            font-size: 2.5em;
            margin-bottom: 10px;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.3);
        }

        .header p {
            font-size: 1.1em;
            opacity: 0.9;
        }

        .tabs {
            display: flex;
            background: #f5f5f5;
            border-bottom: 2px solid #ddd;
            overflow-x: auto;
        }

        .tab {
            flex: 1;
            padding: 15px 20px;
            background: #f5f5f5;
            border: none;
            cursor: pointer;
            font-size: 16px;
            font-weight: 600;
            transition: all 0.3s;
            border-right: 1px solid #ddd;
            white-space: nowrap;
        }

        .tab:hover {
            background: #e0e0e0;
        }

        .tab.active {
            background: white;
            color: #2a5298;
            border-bottom: 3px solid #2a5298;
        }

        .content {
            padding: 30px;
        }

        .tab-content {
            display: none;
        }

        .tab-content.active {
            display: block;
            animation: fadeIn 0.3s;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .form-section {
            background: #f9f9f9;
            padding: 25px;
            border-radius: 10px;
            margin-bottom: 20px;
            border-left: 4px solid #2a5298;
        }

        .form-section h3 {
            color: #2a5298;
            margin-bottom: 20px;
            font-size: 1.4em;
            display: flex;
            align-items: center;
        }

        .form-section h3::before {
            content: "â–¶";
            margin-right: 10px;
            font-size: 0.8em;
        }

        .form-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
        }

        .form-group {
            display: flex;
            flex-direction: column;
        }

        .form-group label {
            font-weight: 600;
            margin-bottom: 8px;
            color: #333;
            font-size: 14px;
        }

        .form-group input,
        .form-group select {
            padding: 12px;
            border: 2px solid #ddd;
            border-radius: 8px;
            font-size: 16px;
            transition: all 0.3s;
        }

        .form-group input:focus,
        .form-group select:focus {
            outline: none;
            border-color: #2a5298;
            box-shadow: 0 0 0 3px rgba(42, 82, 152, 0.1);
        }

        .unit {
            font-size: 12px;
            color: #666;
            margin-top: 4px;
        }

        .btn {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border: none;
            padding: 15px 40px;
            font-size: 18px;
            font-weight: 600;
            border-radius: 10px;
            cursor: pointer;
            transition: all 0.3s;
            box-shadow: 0 4px 15px rgba(0,0,0,0.2);
            margin: 10px 5px;
        }

        .btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(0,0,0,0.3);
        }

        .btn:active {
            transform: translateY(0);
        }

        .btn-secondary {
            background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);
        }

        .results-section {
            background: white;
            padding: 25px;
            border-radius: 10px;
            margin-top: 20px;
            border: 2px solid #2a5298;
        }

        .results-section h3 {
            color: #2a5298;
            margin-bottom: 20px;
            font-size: 1.5em;
            border-bottom: 2px solid #2a5298;
            padding-bottom: 10px;
        }

        .result-item {
            display: flex;
            justify-content: space-between;
            padding: 12px;
            margin-bottom: 8px;
            background: #f9f9f9;
            border-radius: 6px;
            transition: all 0.3s;
        }

        .result-item:hover {
            background: #f0f0f0;
            transform: translateX(5px);
        }

        .result-label {
            font-weight: 600;
            color: #333;
        }

        .result-value {
            font-weight: 700;
            color: #2a5298;
            font-size: 1.1em;
        }

        .result-value.success {
            color: #28a745;
        }

        .result-value.warning {
            color: #ffc107;
        }

        .result-value.danger {
            color: #dc3545;
        }

        .table-container {
            overflow-x: auto;
            margin-top: 20px;
        }

        table {
            width: 100%;
            border-collapse: collapse;
            background: white;
            border-radius: 8px;
            overflow: hidden;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }

        th {
            background: linear-gradient(135deg, #2a5298 0%, #1e3c72 100%);
            color: white;
            padding: 15px;
            text-align: left;
            font-weight: 600;
        }

        td {
            padding: 12px 15px;
            border-bottom: 1px solid #ddd;
        }

        tr:hover {
            background: #f5f5f5;
        }

        .formula-box {
            background: #fff3cd;
            border-left: 4px solid #ffc107;
            padding: 15px;
            margin: 15px 0;
            border-radius: 5px;
            font-family: 'Courier New', monospace;
        }

        .formula-box strong {
            color: #856404;
        }

        .warning-box {
            background: #f8d7da;
            border-left: 4px solid #dc3545;
            padding: 15px;
            margin: 15px 0;
            border-radius: 5px;
            color: #721c24;
        }

        .success-box {
            background: #d4edda;
            border-left: 4px solid #28a745;
            padding: 15px;
            margin: 15px 0;
            border-radius: 5px;
            color: #155724;
        }

        .info-box {
            background: #d1ecf1;
            border-left: 4px solid #17a2b8;
            padding: 15px;
            margin: 15px 0;
            border-radius: 5px;
            color: #0c5460;
        }

        canvas {
            max-width: 100%;
            height: auto;
            margin: 20px 0;
            border: 2px solid #ddd;
            border-radius: 10px;
            background: white;
        }

        .button-group {
            display: flex;
            flex-wrap: wrap;
            gap: 10px;
            margin: 20px 0;
        }

        .chart-container {
            position: relative;
            height: 400px;
            margin: 20px 0;
        }

        @media (max-width: 768px) {
            .form-grid {
                grid-template-columns: 1fr;
            }
            
            .tabs {
                flex-direction: column;
            }
            
            .header h1 {
                font-size: 1.8em;
            }
            
            .result-item {
                flex-direction: column;
                gap: 5px;
            }
        }

        .loading {
            display: none;
            text-align: center;
            padding: 20px;
        }

        .loading.active {
            display: block;
        }

        .spinner {
            border: 4px solid #f3f3f3;
            border-top: 4px solid #2a5298;
            border-radius: 50%;
            width: 40px;
            height: 40px;
            animation: spin 1s linear infinite;
            margin: 0 auto;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        .priority-badge {
            display: inline-block;
            padding: 4px 10px;
            border-radius: 12px;
            font-size: 12px;
            font-weight: 600;
            margin-left: 10px;
        }

        .priority-1 {
            background: #dc3545;
            color: white;
        }

        .priority-2 {
            background: #ffc107;
            color: #333;
        }

        .priority-3 {
            background: #17a2b8;
            color: white;
        }

        .solution-card {
            background: white;
            padding: 15px;
            margin: 15px 0;
            border-radius: 8px;
            border-left: 4px solid #dc3545;
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
            transition: all 0.3s;
        }

        .solution-card:hover {
            box-shadow: 0 4px 12px rgba(0,0,0,0.15);
            transform: translateX(5px);
        }

        .effectiveness-badge {
            display: inline-block;
            padding: 2px 8px;
            border-radius: 8px;
            font-size: 11px;
            font-weight: 600;
            margin-left: 5px;
        }

        .effectiveness-high {
            background: #d4edda;
            color: #155724;
        }

        .effectiveness-very-high {
            background: #28a745;
            color: white;
        }

        .effectiveness-medium {
            background: #fff3cd;
            color: #856404;
        }

        .problem-summary {
            background: linear-gradient(135deg, #fff5f5 0%, #ffe5e5 100%);
            padding: 15px;
            border-radius: 8px;
            margin: 15px 0;
            border: 2px solid #dc3545;
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>ğŸ—ï¸ BETONARME U-KANAL TASARIM UYGULAMASI</h1>
            <p>Hidrolik, Geoteknik, YapÄ±sal Analiz ve Metraj HesaplamalarÄ± - TBDY 2018 & TS 500</p>
        </div>

        <div class="tabs">
            <button class="tab active" onclick="openTab(event, 'giris')">ğŸ“‹ GiriÅŸ Verileri</button>
            <button class="tab" onclick="openTab(event, 'hidrolik')">ğŸ’§ Hidrolik Hesaplar</button>
            <button class="tab" onclick="openTab(event, 'geoteknik')">ğŸ”ï¸ Geoteknik Analiz</button>
            <button class="tab" onclick="openTab(event, 'deprem')">ğŸŒŠ Deprem Analizi</button>
            <button class="tab" onclick="openTab(event, 'stabilite')">âš–ï¸ Stabilite KontrolÃ¼</button>
            <button class="tab" onclick="openTab(event, 'yapisal')">ğŸ”§ YapÄ±sal TasarÄ±m</button>
            <button class="tab" onclick="openTab(event, 'metraj')">ğŸ“Š Metraj</button>
            <button class="tab" onclick="openTab(event, 'rapor')">ğŸ“„ Rapor</button>
        </div>

        <div class="content">
            <!-- GÄ°RÄ°Å VERÄ°LERÄ° -->
            <div id="giris" class="tab-content active">
                <div class="form-section">
                    <h3>Hidrolik Parametreler</h3>
                    <div class="form-grid">
                        <div class="form-group">
                            <label>TasarÄ±m TaÅŸkÄ±n Debisi (Q<sub>T</sub>)</label>
                            <input type="number" id="Q_T" value="50.0" step="0.1">
                            <span class="unit">mÂ³/sn</span>
                        </div>
                        <div class="form-group">
                            <label>Kanal GeniÅŸliÄŸi (b)</label>
                            <input type="number" id="b" value="5.0" step="0.1">
                            <span class="unit">m</span>
                        </div>
                        <div class="form-group">
                            <label>Manning KatsayÄ±sÄ± (n)</label>
                            <input type="number" id="n" value="0.015" step="0.001">
                            <span class="unit">Beton iÃ§in</span>
                        </div>
                        <div class="form-group">
                            <label>Kanal EÄŸimi (S<sub>o</sub>)</label>
                            <input type="number" id="So" value="0.001" step="0.0001">
                            <span class="unit">m/m</span>
                        </div>
                    </div>
                </div>

                <div class="form-section">
                    <h3>Geometrik Parametreler</h3>
                    <div class="form-grid">
                        <div class="form-group">
                            <label>Toplam Duvar YÃ¼ksekliÄŸi (H)</label>
                            <input type="number" id="H" value="6.0" step="0.1">
                            <span class="unit">m</span>
                        </div>
                        <div class="form-group">
                            <label>Temel GeniÅŸliÄŸi (B)</label>
                            <input type="number" id="B" value="3.0" step="0.1">
                            <span class="unit">m (â‰ˆ0.5H)</span>
                        </div>
                        <div class="form-group">
                            <label>Temel KalÄ±nlÄ±ÄŸÄ± (T<sub>H</sub>)</label>
                            <input type="number" id="TH" value="0.6" step="0.05">
                            <span class="unit">m (â‰ˆ0.1H)</span>
                        </div>
                        <div class="form-group">
                            <label>Perde Alt KalÄ±nlÄ±ÄŸÄ± (W<sub>alt</sub>)</label>
                            <input type="number" id="W_alt" value="0.6" step="0.05">
                            <span class="unit">m</span>
                        </div>
                        <div class="form-group">
                            <label>Perde Ãœst KalÄ±nlÄ±ÄŸÄ± (W<sub>Ã¼st</sub>)</label>
                            <input type="number" id="W_ust" value="0.3" step="0.05">
                            <span class="unit">m (min 0.25-0.30m)</span>
                        </div>
                        <div class="form-group">
                            <label>Duvar UzunluÄŸu (L)</label>
                            <input type="number" id="L" value="20.0" step="1">
                            <span class="unit">m</span>
                        </div>
                    </div>
                </div>

                <div class="form-section">
                    <h3>Zemin Parametreleri</h3>
                    <div class="form-grid">
                        <div class="form-group">
                            <label>Zemin Birim Hacim AÄŸÄ±rlÄ±ÄŸÄ± (Î³)</label>
                            <input type="number" id="gamma_zemin" value="18.0" step="0.1">
                            <span class="unit">kN/mÂ³</span>
                        </div>
                        <div class="form-group">
                            <label>Ä°Ã§sel SÃ¼rtÃ¼nme AÃ§Ä±sÄ± (Ï†)</label>
                            <input type="number" id="phi" value="30" step="1">
                            <span class="unit">derece</span>
                        </div>
                        <div class="form-group">
                            <label>Kohezyon (c)</label>
                            <input type="number" id="c" value="0" step="1">
                            <span class="unit">kPa</span>
                        </div>
                        <div class="form-group">
                            <label>Duvar SÃ¼rtÃ¼nme AÃ§Ä±sÄ± (Î´)</label>
                            <input type="number" id="delta" value="20" step="1">
                            <span class="unit">derece (â‰ˆ2/3Ï†)</span>
                        </div>
                        <div class="form-group">
                            <label>SÃ¼rÅŸarj YÃ¼kÃ¼ (q)</label>
                            <input type="number" id="q" value="10" step="1">
                            <span class="unit">kN/mÂ²</span>
                        </div>
                        <div class="form-group">
                            <label>Zemin TaÅŸÄ±ma GÃ¼cÃ¼ (q<sub>ult</sub>)</label>
                            <input type="number" id="q_ult" value="250" step="10">
                            <span class="unit">kN/mÂ²</span>
                        </div>
                    </div>
                </div>

                <div class="form-section">
                    <h3>Deprem Parametreleri (TBDY 2018)</h3>
                    <div class="form-grid">
                        <div class="form-group">
                            <label>S<sub>DS</sub> (KÄ±sa Periyot Spektral Ä°vme - T â‰¤ T<sub>A</sub>)</label>
                            <input type="number" id="SDS" value="0.8" step="0.05">
                            <span class="unit">g (AFAD haritasÄ±ndan)</span>
                        </div>
                        <div class="form-group">
                            <label>S<sub>D1</sub> (1 Saniye Spektral Ä°vme - T > T<sub>B</sub>)</label>
                            <input type="number" id="SD1" value="0.35" step="0.05">
                            <span class="unit">g (AFAD haritasÄ±ndan)</span>
                        </div>
                        <div class="form-group">
                            <label>Yerel Zemin SÄ±nÄ±fÄ± (TBDY Tablo 16.1)</label>
                            <select id="zemin_sinifi">
                                <option value="ZA">ZA - SaÄŸlam, kÄ±rÄ±lmamÄ±ÅŸ kayalar (F_s=0.8)</option>
                                <option value="ZB">ZB - Az ayrÄ±ÅŸmÄ±ÅŸ kayalar (F_s=0.9)</option>
                                <option value="ZC" selected>ZC - Ã‡ok sÄ±kÄ± kum, Ã§akÄ±l, sert kil (F_s=1.3)</option>
                                <option value="ZD">ZD - Orta sÄ±kÄ±-sÄ±kÄ± zemin (F_s=1.6)</option>
                                <option value="ZE">ZE - GevÅŸek kum, yumuÅŸak kil (F_s=2.4)</option>
                            </select>
                            <span class="unit">Zemin etÃ¼dÃ¼ne gÃ¶re</span>
                        </div>
                        <div class="form-group">
                            <label>Azaltma KatsayÄ±sÄ± (r) - TBDY 2018 Tablo 16.4</label>
                            <input type="number" id="r" value="2.0" step="0.1" min="1.5" max="2.5">
                            <span class="unit">Konsol: 2.0-2.5, AnkrajlÄ±: 1.5 (TS 500)</span>
                        </div>
                        <div class="form-group">
                            <label>TasarÄ±m YaklaÅŸÄ±mÄ±</label>
                            <select id="tasarim_yaklasimi">
                                <option value="TBDY" selected>TBDY 2018 (Karakteristik DeÄŸerler)</option>
                                <option value="EC7_DA1">TS EN 1997-1 YaklaÅŸÄ±m DA1</option>
                                <option value="EC7_DA2">TS EN 1997-1 YaklaÅŸÄ±m DA2</option>
                            </select>
                            <span class="unit">Geoteknik tasarÄ±m standardÄ±</span>
                        </div>
                    </div>
                </div>

                <div class="form-section">
                    <h3>Malzeme Ã–zellikleri</h3>
                    <div class="form-grid">
                        <div class="form-group">
                            <label>YapÄ±sal TasarÄ±m StandardÄ±</label>
                            <select id="yapisal_standart">
                                <option value="TS500" selected>TS 500:2000</option>
                                <option value="EC2">TS EN 1992-1-1 (Eurocode 2)</option>
                            </select>
                            <span class="unit">Betonarme tasarÄ±m kodu</span>
                        </div>
                        <div class="form-group">
                            <label>Beton SÄ±nÄ±fÄ±</label>
                            <select id="beton_sinifi">
                                <option value="C25">C25/30</option>
                                <option value="C30" selected>C30/37</option>
                                <option value="C35">C35/45</option>
                                <option value="C40">C40/50</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label>DonatÄ± Ã‡eliÄŸi</label>
                            <select id="donati_sinifi">
                                <option value="B420C" selected>B420C</option>
                                <option value="B500C">B500C</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label>Ã‡evre KoÅŸullarÄ± SÄ±nÄ±fÄ± (TS 500 Tablo 7.2)</label>
                            <select id="cevre_sinifi">
                                <option value="XC1">XC1 - Kuru veya sÃ¼rekli Ä±slak (Ã¶rtÃ¼ 20mm)</option>
                                <option value="XC2">XC2 - Islak, nadiren kuru (Ã¶rtÃ¼ 25mm)</option>
                                <option value="XC3">XC3 - Orta nem (Ã¶rtÃ¼ 25mm)</option>
                                <option value="XC4" selected>XC4 - DÃ¶nÃ¼ÅŸÃ¼mlÃ¼ Ä±slak-kuru (Ã¶rtÃ¼ 30mm)</option>
                                <option value="XD1">XD1 - Orta nem + klorÃ¼r (Ã¶rtÃ¼ 40mm)</option>
                                <option value="XD2">XD2 - Islak + klorÃ¼r (Ã¶rtÃ¼ 40mm)</option>
                                <option value="XS1">XS1 - Deniz havasÄ± (Ã¶rtÃ¼ 40mm)</option>
                                <option value="XS2">XS2 - Deniz suyuna batÄ±k (Ã¶rtÃ¼ 45mm)</option>
                                <option value="XS3">XS3 - Gelgit + dalga (Ã¶rtÃ¼ 50mm)</option>
                            </select>
                            <span class="unit">DayanÄ±klÄ±lÄ±k iÃ§in</span>
                        </div>
                        <div class="form-group">
                            <label>Beton Birim Hacim AÄŸÄ±rlÄ±ÄŸÄ± (Î³<sub>c</sub>)</label>
                            <input type="number" id="gamma_beton" value="25.0" step="0.1">
                            <span class="unit">kN/mÂ³</span>
                        </div>
                        <div class="form-group">
                            <label>Su Birim Hacim AÄŸÄ±rlÄ±ÄŸÄ± (Î³<sub>w</sub>)</label>
                            <input type="number" id="gamma_su" value="9.81" step="0.01">
                            <span class="unit">kN/mÂ³</span>
                        </div>
                    </div>
                </div>

                <div class="button-group">
                    <button class="btn" onclick="calculateAll()">ğŸš€ TÃ¼m HesaplamalarÄ± Yap</button>
                    <button class="btn btn-secondary" onclick="quickOptimize()">âš¡ HÄ±zlÄ± Optimizasyon</button>
                    <button class="btn btn-secondary" onclick="resetForm()">ğŸ”„ SÄ±fÄ±rla</button>
                </div>
            </div>

            <!-- HÄ°DROLÄ°K HESAPLAR -->
            <div id="hidrolik" class="tab-content">
                <div class="results-section">
                    <h3>ğŸ’§ Hidrolik Hesaplama SonuÃ§larÄ±</h3>
                    <div id="hidrolik-sonuc"></div>
                </div>
            </div>

            <!-- GEOTEKNÄ°K ANALÄ°Z -->
            <div id="geoteknik" class="tab-content">
                <div class="results-section">
                    <h3>ğŸ”ï¸ Geoteknik Analiz SonuÃ§larÄ±</h3>
                    <div id="geoteknik-sonuc"></div>
                </div>
            </div>

            <!-- DEPREM ANALÄ°ZÄ° -->
            <div id="deprem" class="tab-content">
                <div class="results-section">
                    <h3>ğŸŒŠ Deprem Etkisi (TBDY 2018)</h3>
                    <div id="deprem-sonuc"></div>
                </div>
            </div>

            <!-- STABÄ°LÄ°TE KONTROLÃœ -->
            <div id="stabilite" class="tab-content">
                <div class="results-section">
                    <h3>âš–ï¸ Stabilite Kontrol SonuÃ§larÄ±</h3>
                    <div id="stabilite-sonuc"></div>
                </div>
            </div>

            <!-- YAPISAL TASARIM -->
            <div id="yapisal" class="tab-content">
                <div class="results-section">
                    <h3>ğŸ”§ YapÄ±sal TasarÄ±m ve DonatÄ± HesabÄ± (TS 500)</h3>
                    <div id="yapisal-sonuc"></div>
                </div>
            </div>

            <!-- METRAJ -->
            <div id="metraj" class="tab-content">
                <div class="results-section">
                    <h3>ğŸ“Š Metraj HesaplamalarÄ±</h3>
                    <div id="metraj-sonuc"></div>
                </div>
            </div>

            <!-- RAPOR -->
            <div id="rapor" class="tab-content">
                <div class="results-section">
                    <h3>ğŸ“„ Teknik Hesap Raporu</h3>
                    <div id="rapor-sonuc"></div>
                    <div class="button-group">
                        <button class="btn" onclick="printReport()">ğŸ–¨ï¸ Raporu YazdÄ±r</button>
                        <button class="btn btn-secondary" onclick="exportToExcel()">ğŸ“Š Excel'e Aktar</button>
                        <button class="btn btn-secondary" onclick="saveCurrentDesign()">ğŸ’¾ TasarÄ±mÄ± Kaydet</button>
                        <button class="btn btn-secondary" onclick="compareDesigns()">ğŸ”„ TasarÄ±mlarÄ± KarÅŸÄ±laÅŸtÄ±r</button>
                    </div>
                    <div id="comparison-area"></div>
                </div>
            </div>
        </div>
    </div>

    <script>
        let calculationResults = {};
        let savedDesign = null;

        function openTab(evt, tabName) {
            const tabContents = document.getElementsByClassName('tab-content');
            for (let i = 0; i < tabContents.length; i++) {
                tabContents[i].classList.remove('active');
            }

            const tabs = document.getElementsByClassName('tab');
            for (let i = 0; i < tabs.length; i++) {
                tabs[i].classList.remove('active');
            }

            document.getElementById(tabName).classList.add('active');
            evt.currentTarget.classList.add('active');
        }

        function getInputValues() {
            return {
                // Hidrolik
                Q_T: parseFloat(document.getElementById('Q_T').value),
                b: parseFloat(document.getElementById('b').value),
                n: parseFloat(document.getElementById('n').value),
                So: parseFloat(document.getElementById('So').value),
                
                // Geometri
                H: parseFloat(document.getElementById('H').value),
                B: parseFloat(document.getElementById('B').value),
                TH: parseFloat(document.getElementById('TH').value),
                W_alt: parseFloat(document.getElementById('W_alt').value),
                W_ust: parseFloat(document.getElementById('W_ust').value),
                L: parseFloat(document.getElementById('L').value),
                
                // Zemin
                gamma_zemin: parseFloat(document.getElementById('gamma_zemin').value),
                phi: parseFloat(document.getElementById('phi').value),
                c: parseFloat(document.getElementById('c').value),
                delta: parseFloat(document.getElementById('delta').value),
                q: parseFloat(document.getElementById('q').value),
                q_ult: parseFloat(document.getElementById('q_ult').value),
                
                // Deprem
                SDS: parseFloat(document.getElementById('SDS').value),
                zemin_sinifi: document.getElementById('zemin_sinifi').value,
                r: parseFloat(document.getElementById('r').value),
                tasarim_yaklasimi: document.getElementById('tasarim_yaklasimi').value,
                
                // Malzeme
                yapisal_standart: document.getElementById('yapisal_standart').value,
                beton_sinifi: document.getElementById('beton_sinifi').value,
                donati_sinifi: document.getElementById('donati_sinifi').value,
                cevre_sinifi: document.getElementById('cevre_sinifi').value,
                gamma_beton: parseFloat(document.getElementById('gamma_beton').value),
                gamma_su: parseFloat(document.getElementById('gamma_su').value)
            };
        }

        function calculateHydraulics(inputs) {
            const results = {};

            // GiriÅŸ deÄŸerlerinin kontrol edilmesi
            if (!inputs.Q_T || inputs.Q_T <= 0) {
                results.h_su = 0;
                results.V = 0;
                results.A = 0;
                results.R_h = 0;
                results.P = inputs.b;
                results.H_p = 0.3;
                results.H_h = 0.3;
                results.Fr = 0;
                results.flow_type = "Bilgi yok";
                results.P_w = 0;
                return results;
            }

            // Manning denklemi ile iteratif su derinliÄŸi hesabÄ±
            let h_su = Math.max(0.1, inputs.Q_T / (inputs.b * 2)); // Daha iyi baÅŸlangÄ±Ã§ tahmini
            let tolerance = 0.01;
            let maxIter = 50;
            let converged = false;

            for (let i = 0; i < maxIter; i++) {
                const A = inputs.b * h_su;
                const P = inputs.b + 2 * h_su;
                const R_h = A / P;

                if (R_h <= 0 || inputs.n <= 0 || inputs.So <= 0) {
                    console.error('GeÃ§ersiz hidrolik parametreleri:', {R_h, n: inputs.n, So: inputs.So});
                    break;
                }

                const V = (1 / inputs.n) * Math.pow(R_h, 2/3) * Math.pow(inputs.So, 1/2);
                const Q_calc = A * V;

                const error = Math.abs(Q_calc - inputs.Q_T);
                if (error < tolerance) {
                    results.h_su = h_su;
                    results.V = V;
                    results.A = A;
                    results.R_h = R_h;
                    results.P = P;
                    converged = true;
                    break;
                }

                // GeliÅŸtirilmiÅŸ Newton-Raphson yaklaÅŸÄ±mÄ±
                if (V > 0 && !isNaN(V)) {
                    const dQ_dh = inputs.b * V + A * (1 / inputs.n) * (2/3) * Math.pow(R_h, -1/3) *
                                  (inputs.b * P - A * 2) / (P * P) * Math.pow(inputs.So, 1/2);

                    if (Math.abs(dQ_dh) > 0.001) {
                        h_su = h_su + 0.5 * (inputs.Q_T - Q_calc) / dQ_dh;
                        h_su = Math.max(0.01, Math.min(h_su, 20)); // SÄ±nÄ±r kontrol
                    } else {
                        break;
                    }
                } else {
                    break;
                }
            }

            // DeÄŸerlerin tanÄ±mlanmadÄ±ÄŸÄ± durumda varsayÄ±lan deÄŸerler
            if (!converged || isNaN(results.h_su)) {
                // Basit yaklaÅŸÄ±m: Manning denklemi doÄŸrusal Ã§Ã¶zÃ¼m
                const h_estimate = Math.pow((inputs.Q_T * inputs.n) / (inputs.b * Math.pow(inputs.So, 0.5)), 0.6);
                results.h_su = Math.max(0.1, h_estimate);
                results.A = inputs.b * results.h_su;
                results.P = inputs.b + 2 * results.h_su;
                results.R_h = results.A / results.P;
                results.V = (1 / inputs.n) * Math.pow(results.R_h, 2/3) * Math.pow(inputs.So, 1/2);
            }

            // Hava payÄ± (Freeboard)
            results.H_p = Math.max(0.3, 0.1 * results.h_su);
            results.H_h = results.h_su + results.H_p;

            // Froude sayÄ±sÄ±
            if (results.h_su > 0) {
                results.Fr = results.V / Math.sqrt(9.81 * results.h_su);
                results.flow_type = results.Fr < 1 ? "Kritik AltÄ± (Sakin)" : results.Fr > 1 ? "Kritik ÃœstÃ¼ (HÄ±zlÄ±)" : "Kritik";
            } else {
                results.Fr = 0;
                results.flow_type = "HesaplanamadÄ±";
            }

            // Hidrostatik basÄ±nÃ§
            results.P_w = 0.5 * inputs.gamma_su * Math.pow(results.h_su, 2);

            return results;
        }

        function calculateBearingCapacity(inputs, e) {
            const phi_rad = inputs.phi * Math.PI / 180;
            const results = {};
            
            // TaÅŸÄ±ma gÃ¼cÃ¼ katsayÄ±larÄ± (Terzaghi-Meyerhof)
            const N_q = Math.exp(Math.PI * Math.tan(phi_rad)) * 
                        Math.pow(Math.tan(Math.PI/4 + phi_rad/2), 2);
            const N_c = (N_q - 1) / Math.tan(phi_rad);
            const N_gamma = 2 * (N_q + 1) * Math.tan(phi_rad);
            
            results.N_q = N_q;
            results.N_c = N_c;
            results.N_gamma = N_gamma;
            
            // Åekil faktÃ¶rleri (DikdÃ¶rtgen temel, uzun duvar)
            const B_eff = inputs.B - 2 * Math.abs(e);
            const s_c = 1.0;  // Uzun temel
            const s_q = 1.0;
            const s_gamma = 0.6;
            
            // Derinlik faktÃ¶rleri
            const D_B_ratio = inputs.TH / B_eff;
            const d_c = 1.0 + 0.4 * Math.min(D_B_ratio, 1.0);
            const d_q = 1.0 + 2 * Math.tan(phi_rad) * 
                        Math.pow(1 - Math.sin(phi_rad), 2) * Math.min(D_B_ratio, 1.0);
            const d_gamma = 1.0;
            
            // EÄŸim faktÃ¶rleri (basitleÅŸtirilmiÅŸ - yatay yÃ¼k etkisi ihmal edilebilir)
            const i_c = 1.0;
            const i_q = 1.0;
            const i_gamma = 1.0;
            
            // TaÅŸÄ±ma gÃ¼cÃ¼ hesabÄ±
            const q_temel = inputs.gamma_zemin * inputs.TH; // Temel seviyesindeki dÃ¼ÅŸey gerilme
            
            const q_ult_hesaplanan = 
                inputs.c * N_c * s_c * d_c * i_c + 
                q_temel * N_q * s_q * d_q * i_q +
                0.5 * inputs.gamma_zemin * B_eff * N_gamma * s_gamma * d_gamma * i_gamma;
            
            results.B_eff = B_eff;
            results.q_ult_hesaplanan = q_ult_hesaplanan;
            results.s_c = s_c;
            results.s_q = s_q;
            results.s_gamma = s_gamma;
            results.d_c = d_c;
            results.d_q = d_q;
            results.d_gamma = d_gamma;
            
            return results;
        }

        function calculateGeotechnics(inputs) {
            const results = {};

            // TS 500 ve Geoteknik UygulamalarÄ± - Duvar-zemin sÃ¼rtÃ¼nme kontrolÃ¼
            // Î´ â‰¤ (2/3)Ï† sÄ±nÄ±rlamasÄ±
            const phi_rad = inputs.phi * Math.PI / 180;
            const delta_rad = inputs.delta * Math.PI / 180;
            const delta_max_rad = (2/3) * phi_rad;
            const delta_max_deg = delta_max_rad * 180 / Math.PI;

            results.delta_max = delta_max_deg;
            results.delta_warning = false;

            if (inputs.delta > delta_max_deg) {
                results.delta_warning = true;
                results.delta_warning_msg =
                    'UYARI: Î´ = ' + inputs.delta.toFixed(2) + 'Â° > (2/3)Ï† = ' +
                    delta_max_deg.toFixed(2) + 'Â°. Duvar-zemin sÃ¼rtÃ¼nme aÃ§Ä±sÄ± Ã§ok yÃ¼ksek! ' +
                    'TS 500 ve geoteknik standartlarÄ±na gÃ¶re Î´ â‰¤ (2/3)Ï† olmalÄ±dÄ±r. ' +
                    'Hesaplamalar Î´ = ' + delta_max_deg.toFixed(2) + 'Â° ile yapÄ±lacaktÄ±r.';

                // UyarÄ± durumunda Î´'yi sÄ±nÄ±rlÄ± deÄŸere ayarla
                inputs.delta = delta_max_deg;
            }

            // Aktif toprak basÄ±ncÄ± katsayÄ±sÄ± (Rankine - basit durum)
            results.K_a_rankine = Math.pow(Math.tan(Math.PI/4 - phi_rad/2), 2);

            // Coulomb teorisi (genel durum - duvar sÃ¼rtÃ¼nmesi dahil)
            // Î± = 90Â° (dÃ¼ÅŸey duvar), Î² = 0Â° (yatay dolgu yÃ¼zeyi) varsayÄ±mÄ±
            const alpha = Math.PI / 2; // 90Â° (dÃ¼ÅŸey duvar)
            const beta = 0; // 0Â° (yatay dolgu)

            const sin_alpha_phi = Math.sin(alpha + phi_rad);
            const sin_alpha = Math.sin(alpha);
            const sin_alpha_delta = Math.sin(alpha - delta_rad);
            const sin_alpha_beta = Math.sin(alpha + beta);
            const sin_phi_delta = Math.sin(phi_rad + delta_rad);
            const sin_phi_beta = Math.sin(phi_rad - beta);

            let K_a_coulomb;
            const term_inside_sqrt = (sin_phi_delta * sin_phi_beta) / (sin_alpha_delta * sin_alpha_beta);

            if (term_inside_sqrt >= 0) {
                const denominator = Math.pow(sin_alpha, 2) * sin_alpha_delta *
                                   Math.pow(1 + Math.sqrt(term_inside_sqrt), 2);
                K_a_coulomb = Math.pow(sin_alpha_phi, 2) / denominator;
            } else {
                K_a_coulomb = results.K_a_rankine; // GeÃ§ersiz durum, Rankine kullan
            }

            results.K_a_coulomb = K_a_coulomb;

            // KullanÄ±lacak katsayÄ± (Coulomb daha genel ve doÄŸru)
            results.K_a = K_a_coulomb;
            results.teori = 'Coulomb (duvar sÃ¼rtÃ¼nmesi dahil)';

            // Pasif toprak basÄ±ncÄ± katsayÄ±sÄ±
            results.K_p = Math.pow(Math.tan(Math.PI/4 + phi_rad/2), 2);

            // Statik aktif toprak itkisi
            results.P_a = 0.5 * inputs.gamma_zemin * Math.pow(inputs.H, 2) * results.K_a;
            results.P_a_arm = inputs.H / 3;
            
            // SÃ¼rÅŸarj itkisi
            results.P_q = inputs.q * inputs.H * results.K_a;
            results.P_q_arm = inputs.H / 2;
            
            // Toplam yatay itki (statik)
            results.P_h_static = results.P_a + results.P_q;
            
            // AÄŸÄ±rlÄ±klar hesabÄ±
            const W_ort = (inputs.W_alt + inputs.W_ust) / 2;
            const H_perde = inputs.H - inputs.TH;
            
            // Temel aÄŸÄ±rlÄ±ÄŸÄ±
            results.W_temel = inputs.gamma_beton * inputs.B * inputs.TH;
            
            // Perde aÄŸÄ±rlÄ±ÄŸÄ±
            results.W_perde = inputs.gamma_beton * W_ort * H_perde;
            
            // Topuk Ã¼stÃ¼ zemin aÄŸÄ±rlÄ±ÄŸÄ±
            const L_topuk = inputs.B - inputs.W_alt - 0.5; // YaklaÅŸÄ±k topuk uzunluÄŸu
            results.W_zemin = inputs.gamma_zemin * L_topuk * H_perde;
            
            // Toplam dÃ¼ÅŸey yÃ¼k
            results.V_total = results.W_temel + results.W_perde + results.W_zemin;
            
            return results;
        }

        function calculateSeismic(inputs, geoResults) {
            const results = {};

            // Ä°stinat yapÄ±sÄ± periyodu hesabÄ± (TBDY 2018 iÃ§in kontrol)
            // BasitleÅŸtirilmiÅŸ formÃ¼l: T â‰ˆ 0.05 * H (konsol istinat iÃ§in)
            const T = 0.05 * inputs.H; // saniye
            results.T = T;

            // TBDY 2018 Tablo 16.1 - Zemin sÄ±nÄ±fÄ± katsayÄ±larÄ±
            const F_s_values = {
                'ZA': 0.8,
                'ZB': 0.9,
                'ZC': 1.3,
                'ZD': 1.6,
                'ZE': 2.4
            };

            // TBDY 2018 - Uzun periyot spektral ivme faktÃ¶rleri (F_1)
            const F_1_values = {
                'ZA': 0.8,
                'ZB': 0.8,
                'ZC': 1.4,
                'ZD': 2.0,
                'ZE': 3.5
            };

            const F_s = F_s_values[inputs.zemin_sinifi];
            const F_1 = F_1_values[inputs.zemin_sinifi];
            results.F_s = F_s;
            results.F_1 = F_1;

            // TBDY 2018 - Periyot sÄ±nÄ±rlarÄ± (T_A, T_B, T_C)
            // T_A = 0.2s (sabit), T_B = T_A (basitleÅŸtirilmiÅŸ), T_C = 1.5s (genel kabuller)
            const T_A = 0.2;
            const T_B = T_A;
            const T_C = 1.5;
            results.T_A = T_A;
            results.T_B = T_B;
            results.T_C = T_C;

            // Spektral ivme hesabÄ± - BÃ¶lgesel kontrol
            let S_D = 0;
            if (T <= T_A) {
                // KÄ±sa periyot bÃ¶lgesi (T â‰¤ T_A)
                S_D = inputs.SDS * F_s;
                results.spektral_bolge = 'KÄ±sa Periyot (T â‰¤ T_A): S_D = S_DS Ã— F_s';
            } else if (T > T_A && T <= T_C) {
                // Uzun periyot bÃ¶lgesi (T_A < T â‰¤ T_C)
                S_D = inputs.SD1 * F_1 / T;
                results.spektral_bolge = 'Uzun Periyot (T_A < T â‰¤ T_C): S_D = S_D1 Ã— F_1 / T';
            } else {
                // Ã‡ok uzun periyot (T > T_C)
                S_D = inputs.SD1 * F_1 * T_C / (T * T);
                results.spektral_bolge = 'Ã‡ok Uzun Periyot (T > T_C): S_D = (S_D1 Ã— F_1 Ã— T_C) / TÂ²';
            }

            results.S_D = S_D;
            // Zemin sÄ±nÄ±fÄ±na gÃ¶re dÃ¼zeltilmiÅŸ spektral ivme
            const S_DS_zemin = inputs.SDS * F_s;
            results.S_DS_zemin = S_DS_zemin;
            
            // Yatay deprem katsayÄ±sÄ± (TBDY 2018 Madde 16.5.2)
            // S_D: YapÄ±nÄ±n periyoduna gÃ¶re hesaplanan spektral ivme
            results.k_h = 0.4 * S_D / inputs.r;

            // DÃ¼ÅŸey deprem katsayÄ±sÄ± (TBDY 2018 Madde 16.5.3)
            results.k_v = (2/3) * results.k_h;  // Daha doÄŸru formÃ¼l
            
            // Tam Mononobe-Okabe formÃ¼lÃ¼ (TBDY 2018 Madde 16.5.5)
            const phi_rad = inputs.phi * Math.PI / 180;
            const delta_rad = inputs.delta * Math.PI / 180;
            const beta = 0; // Duvar dÃ¼ÅŸey kabulu
            const i = 0; // Dolgu yÃ¼zeyi yatay kabulu
            
            const theta = Math.atan(results.k_h / (1 - results.k_v));
            results.theta = theta * 180 / Math.PI;
            
            // Tam TBDY formÃ¼lÃ¼
            const cos_phi_theta_beta = Math.cos(phi_rad - theta - beta);
            const cos_theta = Math.cos(theta);
            const cos_beta = Math.cos(beta);
            const cos_delta_beta_theta = Math.cos(delta_rad + beta + theta);
            const cos_i_beta = Math.cos(i - beta);
            
            const numerator = Math.pow(cos_phi_theta_beta, 2);
            
            const sin_phi_delta = Math.sin(phi_rad + delta_rad);
            const sin_phi_theta_i = Math.sin(phi_rad - theta - i);
            
            let sqrt_term = 0;
            if (cos_delta_beta_theta > 0 && cos_i_beta > 0) {
                const inner = (sin_phi_delta * sin_phi_theta_i) / 
                             (cos_delta_beta_theta * cos_i_beta);
                if (inner >= 0) {
                    sqrt_term = Math.sqrt(inner);
                }
            }
            
            const denominator = cos_theta * Math.pow(cos_beta, 2) * 
                               cos_delta_beta_theta * Math.pow(1 + sqrt_term, 2);
            
            results.K_ae = numerator / denominator;
            
            // k_v'nin iki durumu iÃ§in kontrol (1-k_v ve 1+k_v)
            // Daha kritik olan 1-k_v kullanÄ±lÄ±r
            const factor_kv = 1 - results.k_v;
            
            // Toplam dinamik itki (TBDY 2018 Denklem 16.23)
            results.P_t = results.K_ae * factor_kv * 
                         (0.5 * inputs.gamma_zemin * Math.pow(inputs.H, 2) + 
                          inputs.q * inputs.H);
            
            // Dinamik itki artÄ±ÅŸÄ±
            results.Delta_P = results.P_t - geoResults.P_h_static;
            results.P_t_arm = inputs.H / 2; // Dinamik bileÅŸke ortada (TBDY)
            
            // Alternatif: 1+k_v durumu (karÅŸÄ±laÅŸtÄ±rma iÃ§in)
            const P_t_alt = results.K_ae * (1 + results.k_v) * 
                           (0.5 * inputs.gamma_zemin * Math.pow(inputs.H, 2) + 
                            inputs.q * inputs.H);
            results.P_t_alternatif = P_t_alt;
            
            // Daha kritik olanÄ± kullan
            if (P_t_alt > results.P_t) {
                results.P_t = P_t_alt;
                results.Delta_P = results.P_t - geoResults.P_h_static;
                results.kv_durum = '(1+k_v) kullanÄ±ldÄ±';
            } else {
                results.kv_durum = '(1-k_v) kullanÄ±ldÄ±';
            }

            // Deprem yÃ¶n kuralÄ± (TBDY 2018 Madde 4.4.3)
            // Ä°ki yÃ¶nlÃ¼ deprem etkisi kombinasyonlarÄ±
            // U-kanal iÃ§in: x-yÃ¶nÃ¼ (duvar enkesit), y-yÃ¶nÃ¼ (kanal ekseni)
            // BasitleÅŸtirilmiÅŸ yaklaÅŸÄ±m: Enine yÃ¶n etkisi %30 olarak alÄ±nÄ±r
            const E_x = results.Delta_P; // X-yÃ¶nÃ¼ (ana etki)
            const E_y = 0.3 * E_x; // Y-yÃ¶nÃ¼ (%30 azaltÄ±lmÄ±ÅŸ)

            // Ä°ki kombinasyon
            const E_combo_1 = E_x + 0.3 * E_y; // E_x + 0.3E_y
            const E_combo_2 = 0.3 * E_x + E_y; // 0.3E_x + E_y

            // Kritik kombinasyon
            const E_tasarim = Math.max(E_combo_1, E_combo_2);

            results.E_x = E_x;
            results.E_y = E_y;
            results.E_combo_1 = E_combo_1;
            results.E_combo_2 = E_combo_2;
            results.E_tasarim = E_tasarim;
            results.deprem_yon_bilgi = E_combo_1 >= E_combo_2 ? 'E_x + 0.3E_y kritik' : '0.3E_x + E_y kritik';

            // Not: Delta_P ana hesaplarda kullanÄ±lmaya devam eder
            // E_tasarim sadece bilgi amaÃ§lÄ±dÄ±r (2D analiz iÃ§in)

            return results;
        }

        function calculateStability(inputs, geoResults, seismicResults) {
            const results = {};

            // TS EN 1997-1 (EC7) - KÄ±smi GÃ¼venlik FaktÃ¶rleri UygulamasÄ±
            // TBDY 2018 karakteristik deÄŸerler kullanÄ±yorsa EC7 faktÃ¶rleri yok sayÄ±lÄ±r
            // EC7_DA1 veya EC7_DA2 seÃ§ilirse aÅŸaÄŸÄ±daki faktÃ¶rler kullanÄ±lÄ±r:

            let gamma_G = 1.0, gamma_Q = 1.0, gamma_phi = 1.0, gamma_c = 1.0;
            let ec7_approach = false;

            if (inputs.tasarim_yaklasimi === 'EC7_DA1') {
                // TS EN 1997-1 YaklaÅŸÄ±m DA1 - Kombinasyon 1
                // YapÄ±lara daha uygun (daha az gÃ¼venlik faktÃ¶rÃ¼)
                gamma_G = 1.35;
                gamma_Q = 1.50;
                gamma_phi = 1.0;
                gamma_c = 1.0;
                results.ec7_approach = 'DA1-Kombinasyon 1 (YapÄ±lar)';
                ec7_approach = true;
            } else if (inputs.tasarim_yaklasimi === 'EC7_DA2') {
                // TS EN 1997-1 YaklaÅŸÄ±m DA2
                // Geoteknik daha aÄŸÄ±r faktÃ¶rler ile tasarlanÄ±r
                gamma_G = 1.0;
                gamma_Q = 1.30;
                gamma_phi = 1.25;
                gamma_c = 1.25;
                results.ec7_approach = 'DA2 (Geoteknik)';
                ec7_approach = true;
            } else {
                // TBDY 2018 - Karakteristik deÄŸerler (faktÃ¶rsÃ¼z yÃ¼kler)
                results.ec7_approach = 'TBDY 2018 (Karakteristik DeÄŸerler)';
                ec7_approach = false;
            }

            results.gamma_G = gamma_G;
            results.gamma_Q = gamma_Q;
            results.gamma_phi = gamma_phi;
            results.gamma_c = gamma_c;
            results.ec7_faktÃ¶rleri_uygulanÄ±yor = ec7_approach;

            // STATIK KONTROLLER
            
            // 1. Devrilme kontrolÃ¼
            const M_R_static = geoResults.W_temel * (inputs.B / 2) + 
                              geoResults.W_perde * (inputs.W_alt / 2) + 
                              geoResults.W_zemin * (inputs.B - inputs.W_alt / 2);
            
            const M_D_static = geoResults.P_a * geoResults.P_a_arm + 
                              geoResults.P_q * geoResults.P_q_arm;
            
            results.M_R_static = M_R_static;
            results.M_D_static = M_D_static;
            results.GS_devrilme_static = M_R_static / M_D_static;
            results.devrilme_static_ok = results.GS_devrilme_static >= 2.0;
            
            // 2. Kayma kontrolÃ¼ (Pasif direnÃ§ dahil - TBDY 16.6.2)
            const delta_rad = inputs.delta * Math.PI / 180;
            const F_R_static = geoResults.V_total * Math.tan(delta_rad) + 
                              inputs.c * inputs.B * 1000;
            
            // Pasif toprak direnci (gÃ¼venli taraf iÃ§in %50'si - Terzaghi Ã¶nerisi)
            const H_passive = inputs.TH; // Temel Ã¶nÃ¼ yÃ¼ksekliÄŸi
            const P_p = 0.5 * 0.5 * inputs.gamma_zemin * 
                       Math.pow(H_passive, 2) * geoResults.K_p;
            
            results.P_p = P_p;
            results.F_R_static_without_Pp = F_R_static;
            results.F_R_static = F_R_static + P_p;
            
            const F_D_static = geoResults.P_h_static;
            
            results.GS_kayma_static = results.F_R_static / F_D_static;
            results.kayma_static_ok = results.GS_kayma_static >= 1.5;
            
            // 3. TaÅŸÄ±ma gÃ¼cÃ¼ kontrolÃ¼
            const e_static = (M_R_static - M_D_static) / geoResults.V_total;
            results.e_static = e_static;
            results.e_B_orani_static = e_static / inputs.B;
            results.eksantrisite_static_ok = Math.abs(e_static) < inputs.B / 6;
            
            // TaÅŸÄ±ma gÃ¼cÃ¼ hesaplama
            const bearingResults = calculateBearingCapacity(inputs, e_static);
            results.bearing = bearingResults;
            
            const B_eff = bearingResults.B_eff;
            const q_max_static = (geoResults.V_total / B_eff) * 
                                (1 + 6 * Math.abs(e_static) / inputs.B);
            
            results.q_max_static = q_max_static;
            results.q_ult_hesaplanan = bearingResults.q_ult_hesaplanan;
            
            // KullanÄ±cÄ± giriÅŸi ile hesaplanan deÄŸer karÅŸÄ±laÅŸtÄ±rmasÄ±
            results.q_ult_kullanici = inputs.q_ult;
            results.q_ult_kullanim = Math.min(inputs.q_ult, bearingResults.q_ult_hesaplanan);
            
            results.GS_tasima_static = results.q_ult_kullanim / q_max_static;
            results.tasima_static_ok = results.GS_tasima_static >= 2.5;
            
            // DÄ°NAMÄ°K KONTROLLER
            
            // 1. Devrilme kontrolÃ¼ (dinamik)
            const M_D_dynamic = geoResults.P_a * geoResults.P_a_arm + 
                               geoResults.P_q * geoResults.P_q_arm +
                               seismicResults.Delta_P * seismicResults.P_t_arm;
            
            results.M_D_dynamic = M_D_dynamic;
            results.GS_devrilme_dynamic = M_R_static / M_D_dynamic;
            
            // TBDY 2018 Tablo 16.3 - dinamik devrilme FS â‰¥ 1.5
            const min_GS_devrilme_dynamic = inputs.tasarim_yaklasimi === 'TBDY' ? 1.5 : 1.4;
            results.min_GS_devrilme_dynamic = min_GS_devrilme_dynamic;
            results.devrilme_dynamic_ok = results.GS_devrilme_dynamic >= min_GS_devrilme_dynamic;
            
            // 2. Kayma kontrolÃ¼ (dinamik) - TBDY 2018 Tablo 16.3 FS â‰¥ 1.2
            const F_D_dynamic = seismicResults.P_t;
            results.GS_kayma_dynamic = results.F_R_static / F_D_dynamic;
            const min_GS_kayma_dynamic = inputs.tasarim_yaklasimi === 'TBDY' ? 1.2 : 1.15;
            results.kayma_dynamic_ok = results.GS_kayma_dynamic >= min_GS_kayma_dynamic;
            
            // 3. TaÅŸÄ±ma gÃ¼cÃ¼ kontrolÃ¼ (dinamik)
            const e_dynamic = (M_R_static - M_D_dynamic) / geoResults.V_total;
            results.e_dynamic = e_dynamic;
            results.e_B_orani_dynamic = e_dynamic / inputs.B;
            results.eksantrisite_dynamic_ok = Math.abs(e_dynamic) < inputs.B / 6;
            
            const bearingResultsDynamic = calculateBearingCapacity(inputs, e_dynamic);
            const B_eff_dynamic = bearingResultsDynamic.B_eff;
            
            const q_max_dynamic = (geoResults.V_total / B_eff_dynamic) *
                                 (1 + 6 * Math.abs(e_dynamic) / inputs.B);
            results.q_max_dynamic = q_max_dynamic;
            results.GS_tasima_dynamic = results.q_ult_kullanim / q_max_dynamic;
            // TBDY 2018 Tablo 16.3 - dinamik taÅŸÄ±ma gÃ¼cÃ¼ FS â‰¥ 1.5
            const min_GS_tasima_dynamic = inputs.tasarim_yaklasimi === 'TBDY' ? 1.5 : 1.2;
            results.tasima_dynamic_ok = results.GS_tasima_dynamic >= min_GS_tasima_dynamic;
            
            // Genel deÄŸerlendirme
            results.tum_kontroller_ok = results.devrilme_static_ok && 
                                       results.kayma_static_ok && 
                                       results.tasima_static_ok &&
                                       results.eksantrisite_static_ok &&
                                       results.devrilme_dynamic_ok &&
                                       results.kayma_dynamic_ok &&
                                       results.tasima_dynamic_ok &&
                                       results.eksantrisite_dynamic_ok;
            
            return results;
        }

        function calculateStructural(inputs, geoResults, seismicResults, hydraulicsResults) {
            const results = {};

            // Malzeme Ã¶zellikleri - Standarda gÃ¶re
            const fck_values = {
                'C25': 25, 'C30': 30, 'C35': 35, 'C40': 40
            };
            const fck = fck_values[inputs.beton_sinifi];
            
            if (inputs.yapisal_standart === 'TS500') {
                // TS 500:2000
                results.fcd = fck / 1.5;
                results.fctd = 0.21 * Math.pow(fck, 2/3) / 1.5;
                results.standart = 'TS 500:2000';
            } else {
                // TS EN 1992-1-1 (Eurocode 2)
                const alpha_cc = 0.85; // Uzun dÃ¶nem etki
                const gamma_c = 1.5;
                
                // fctk tablosu (basitleÅŸtirilmiÅŸ)
                const fctk_005_values = {
                    25: 1.8, 30: 2.0, 35: 2.2, 40: 2.5
                };
                const fctk_005 = fctk_005_values[fck] || 2.0;
                const alpha_ct = 1.0;
                
                results.fcd = alpha_cc * fck / gamma_c;
                results.fctd = alpha_ct * fctk_005 / gamma_c;
                results.standart = 'TS EN 1992-1-1 (EC2)';
            }
            
            // DonatÄ± Ã¶zellikleri
            const fyk = inputs.donati_sinifi === 'B420C' ? 420 : 500;
            const fyd = fyk / 1.15;
            
            results.fck = fck;
            results.fyk = fyk;
            results.fyd = fyd;

            // Ã‡evre koÅŸullarÄ± sÄ±nÄ±fÄ±na gÃ¶re minimum Ã¶rtÃ¼ kalÄ±nlÄ±ÄŸÄ± (TS 500 Tablo 7.2)
            const cover_values = {
                'XC1': 0.020, 'XC2': 0.025, 'XC3': 0.025, 'XC4': 0.030,
                'XD1': 0.040, 'XD2': 0.040,
                'XS1': 0.040, 'XS2': 0.045, 'XS3': 0.050
            };
            const c_nom = cover_values[inputs.cevre_sinifi] || 0.030; // varsayÄ±lan 30mm
            results.c_nom = c_nom;
            results.cevre_sinifi = inputs.cevre_sinifi;

            // DOÄRU YÃœK AYIRIMI (KRÄ°TÄ°K DÃœZELTME!)
            // SÃ¼rekli yÃ¼kler (G - Dead Load)
            const G = geoResults.W_temel + geoResults.W_perde + geoResults.W_zemin;

            // Hareketli yÃ¼kler (Q - Live Load) - Toprak itkisi deÄŸiÅŸken yÃ¼k
            const Q = geoResults.P_a + geoResults.P_q;

            // Su basÄ±ncÄ± (kanal iÃ§i - hidrostatik basÄ±nÃ§)
            // Su dolu durum iÃ§in hareketli yÃ¼k olarak kabul edilir
            const P_w = hydraulicsResults ? (hydraulicsResults.P_w || 0) : 0; // kN/m

            // Deprem yÃ¼kÃ¼ (E - Earthquake)
            const E = seismicResults.Delta_P;

            results.G = G;
            results.Q = Q;
            results.P_w = P_w;
            results.E = E;
            
            // YÃ¼k kombinasyonlarÄ± (DÃœZELTME!)
            let V_d_static, V_d_earthquake;
            
            if (inputs.yapisal_standart === 'TS500') {
                // TS 500 - Tablo 7.1
                V_d_static = 1.4 * G + 1.6 * Q;  // SÃ¼rekli durum
                V_d_earthquake = 1.0 * G + 0.3 * Q + 1.0 * E;  // Deprem durumu
            } else {
                // EC2 / TBDY
                V_d_static = 1.35 * G + 1.5 * Q;  // STR/GEO
                V_d_earthquake = 1.0 * G + 0.3 * Q + 1.0 * E;  // Kazara (Deprem)
            }
            
            results.V_d_static = V_d_static;
            results.V_d_earthquake = V_d_earthquake;
            results.V_d_max = Math.max(V_d_static, V_d_earthquake);
            
            // Perde dibi momenti (kritik kesit)
            const H_perde = inputs.H - inputs.TH;

            // Su basÄ±ncÄ± momenti (kanal iÃ§indeki su, iÃ§ yÃ¼zeyden etki eder)
            // P_w toplam hidrostatik basÄ±nÃ§ (kN/m), moment kolu h_su/3
            const h_su = hydraulicsResults ? (hydraulicsResults.h_su || 0) : 0;
            const M_water = P_w * (h_su / 3 + inputs.TH); // kN.m/m (iÃ§ yÃ¼zeyden)

            // Moment hesabÄ± - DoÄŸru yÃ¼k kombinasyonlarÄ± ile
            const M_static_G = 0; // DÃ¼ÅŸey yÃ¼klerin momenti ihmal edilebilir
            const M_static_Q = geoResults.P_a * (geoResults.P_a_arm + inputs.TH) +
                               geoResults.P_q * (geoResults.P_q_arm + inputs.TH);

            // Su basÄ±ncÄ± dÄ±ÅŸ yÃ¼ke zÄ±t yÃ¶nde (azaltÄ±cÄ± etki)
            const M_static_Q_net = M_static_Q - M_water;

            const M_earthquake = M_static_Q_net + E * seismicResults.P_t_arm;

            let M_d_perde;
            if (inputs.yapisal_standart === 'TS500') {
                M_d_perde = 1.6 * M_static_Q_net;  // Statik durum kritik
                const M_d_earthquake = 1.0 * M_earthquake;
                M_d_perde = Math.max(M_d_perde, M_d_earthquake);
            } else {
                M_d_perde = 1.5 * M_static_Q_net;
                const M_d_earthquake = 1.0 * M_earthquake;
                M_d_perde = Math.max(M_d_perde, M_d_earthquake);
            }

            results.M_water = M_water;
            results.h_su = h_su;
            
            results.M_d_perde = M_d_perde;

            // Gerekli donatÄ± alanÄ±
            const fi_donati = 16; // mm (varsayÄ±lan donatÄ± Ã§apÄ±)
            const d = inputs.W_alt - c_nom - fi_donati/2000; // FaydalÄ± yÃ¼kseklik (Ã¶rtÃ¼ + yarÄ±m donatÄ±)
            const mu = M_d_perde / (1.0 * Math.pow(d, 2) * results.fcd * 1000); // 1m geniÅŸlik

            // SÃ¼nek gÃ¶Ã§me kontrolÃ¼ (TS 500 Madde 7.2 - Îµ_s â‰¥ 0.01)
            // Maksimum donatÄ± oranÄ±: Îµ_cu = 0.003, Îµ_s,min = 0.01 iÃ§in
            const eps_cu = 0.003; // Beton ezilme deformasyonu
            const eps_s_min = 0.01; // Minimum donatÄ± deformasyonu (sÃ¼nek gÃ¶Ã§me)
            const x_max_d = eps_cu / (eps_cu + eps_s_min); // x_max / d = 0.003 / 0.013 = 0.231
            const omega_max = 0.85 * x_max_d; // Maksimum Ï‰ â‰ˆ 0.196

            let omega;
            if (mu <= omega_max * 0.85) {
                omega = 0.85 * (1 - Math.sqrt(1 - 2 * mu / 0.85));
            } else {
                omega = omega_max; // Maksimum donatÄ± oranÄ± (sÃ¼nek gÃ¶Ã§me sÄ±nÄ±rÄ±)
                results.sunek_gocme_uyari = true;
            }

            results.omega_max = omega_max;
            
            const As_perde = omega * results.fcd * 1000 * d / results.fyd;
            
            results.As_perde_gerekli = As_perde;
            results.mu = mu;
            results.omega = omega;
            results.d = d;
            
            // Minimum donatÄ± kontrolÃ¼ (TS 500 Â§12)
            const Ag_perde = inputs.W_alt * 1000; // mmÂ² (1m geniÅŸlik)
            const As_min = 0.0025 * Ag_perde / 2; // Her yÃ¼z iÃ§in
            
            results.As_min_perde = As_min;
            results.As_perde_tasarim = Math.max(As_perde, As_min);
            
            // DonatÄ± seÃ§imi (Î¦16 iÃ§in)
            const As_fi16 = Math.PI * Math.pow(16, 2) / 4;
            const n_fi16 = Math.ceil(results.As_perde_tasarim / As_fi16);
            const s_fi16 = 1000 / n_fi16; // mm
            
            results.donati_capi = 16;
            results.donati_adet = n_fi16;
            results.donati_araligi = Math.round(s_fi16);
            
            // Minimum aralÄ±k kontrolÃ¼ (max 300mm veya 1.5*kalÄ±nlÄ±k)
            const s_max = Math.min(300, 1.5 * inputs.W_alt * 1000);
            results.s_max = s_max;
            results.aralÄ±k_ok = results.donati_araligi <= s_max;

            // DonatÄ± sÄ±yrÄ±lma (ankraj) boyu hesabÄ± (TS 500 Madde 8.6)
            const f_bd = inputs.yapisal_standart === 'TS500'
                ? 1.4 * results.fctd  // TS 500: f_bd = 1.4 * f_ctd (nervÃ¼rlÃ¼ donatÄ±)
                : 2.25 * results.fctd; // EC2: farklÄ± formÃ¼l

            const l_b_basic = (fi_donati * results.fyd) / (4 * f_bd); // Temel sÄ±yrÄ±lma boyu (mm)

            // Ankraj boyu katsayÄ±larÄ± (basitleÅŸtirilmiÅŸ, gÃ¼venli taraf)
            const alpha_1 = 1.0; // DonatÄ± ÅŸekli katsayÄ±sÄ± (dÃ¼z donatÄ±)
            const alpha_2 = 1.0; // Beton Ã¶rtÃ¼sÃ¼ katsayÄ±sÄ±
            const alpha_3 = 1.0; // SargÄ± donatÄ±sÄ± katsayÄ±sÄ±
            const alpha_4 = 1.0; // Kaynak katsayÄ±sÄ±
            const alpha_5 = 1.0; // BasÄ±nÃ§ altÄ±nda katsayÄ±

            const l_b_net = l_b_basic * alpha_1 * alpha_2 * alpha_3 * alpha_4 * alpha_5;
            const l_b_min = Math.max(0.3 * l_b_basic, 10 * fi_donati, 100); // mm
            const l_b = Math.max(l_b_net, l_b_min);

            results.f_bd = f_bd;
            results.l_b = l_b / 1000; // m cinsinden
            results.l_b_mm = Math.round(l_b);

            // Temel-perde birleÅŸiminde mevcut uzunluk kontrolÃ¼
            const mevcut_ankraj_uzunlugu = inputs.B * 1000; // Temel geniÅŸliÄŸi (mm)
            results.ankraj_ok = mevcut_ankraj_uzunlugu >= l_b;

            // Kesme kontrolÃ¼ (TS 500 Madde 8.3)
            const V_d_kesme_static = 1.6 * geoResults.P_h_static;
            const V_d_kesme_earthquake = 1.0 * seismicResults.P_t;
            const V_d_kesme = Math.max(V_d_kesme_static, V_d_kesme_earthquake);

            let V_cr;
            if (inputs.yapisal_standart === 'TS500') {
                // TS 500 Madde 8.3 - Etriyesiz kesme dayanÄ±mÄ±
                // V_cr = 0.65 * f_ctd * b_w * d (kN)
                const b_w = inputs.W_alt; // GÃ¶vde geniÅŸliÄŸi (m)
                V_cr = 0.65 * results.fctd * b_w * d * 1000; // kN

                // Not: TS 500'de istinat duvarlarÄ± iÃ§in normal kuvvet etkisi
                // Madde 12'de Ã¶zel kurallar var, ancak basitleÅŸtirilmiÅŸ yaklaÅŸÄ±m kullanÄ±lÄ±yor
            } else {
                // EC2 formÃ¼lÃ¼ (basitleÅŸtirilmiÅŸ)
                const C_Rd_c = 0.18 / 1.5;
                const k = Math.min(1 + Math.sqrt(200 / (d * 1000)), 2.0);
                const rho_l = Math.min(results.As_perde_tasarim / (inputs.W_alt * d * 1000), 0.02);

                V_cr = C_Rd_c * k * Math.pow(100 * rho_l * fck, 1/3) *
                       inputs.W_alt * d * 1000; // kN
            }

            results.V_d_kesme = V_d_kesme;
            results.V_cr = V_cr;
            results.kesme_ok = V_d_kesme <= V_cr;

            // Kesme DonatÄ±sÄ± (Etriye) HesabÄ± (TS 500 Madde 8.5)
            results.kesme_donatisi_gerekli = V_d_kesme > V_cr;

            if (results.kesme_donatisi_gerekli) {
                // Etriye donatÄ±sÄ± alanÄ± hesabÄ±
                // A_sw/s = (V_d - V_cr) / (0.9 * d * f_ywd)
                const f_ywd = results.fyd; // Etriye dayanÄ±mÄ±
                const b_w = inputs.W_alt * 1000; // mm (duvar geniÅŸliÄŸi)

                // Hesaplanan etriye donatÄ± oranÄ±
                const A_sw_s_req = (V_d_kesme - V_cr) / (0.9 * d * f_ywd); // mmÂ²/mm

                // Minimum etriye (TS 500 Â§8.5.3)
                // A_sw_s_min = 0.3 * b_w * f_ctd / f_yk
                const A_sw_s_min = 0.3 * b_w * results.fctd / fyk; // mmÂ²/mm

                // TasarÄ±mda kullanÄ±lacak deÄŸer
                results.A_sw_s_required = Math.max(A_sw_s_req, A_sw_s_min); // mmÂ²/mm
                results.A_sw_s_required_mm2_m = results.A_sw_s_required * 1000; // mmÂ²/m

                // Etriye donatÄ± seÃ§imi (Î¦8 ve Î¦10 iÃ§in)
                const As_fi8 = Math.PI * Math.pow(8, 2) / 4; // mmÂ² (tek fileto)
                const As_fi10 = Math.PI * Math.pow(10, 2) / 4; // mmÂ² (tek fileto)

                // Î¦8 iÃ§in gerekli aralÄ±k
                const s_fi8 = (As_fi8 * 2) / results.A_sw_s_required; // 2 kollu etriye
                // Î¦10 iÃ§in gerekli aralÄ±k
                const s_fi10 = (As_fi10 * 2) / results.A_sw_s_required; // 2 kollu etriye

                // Maksimum etriye aralÄ±ÄŸÄ± (TS 500 Â§8.5.3)
                const s_max_stirrup = Math.min(
                    0.75 * d,
                    300, // mm
                    200  // En sÄ±kÄ± sÄ±nÄ±rÄ±
                );

                results.stirrup_spacing_fi8 = Math.round(Math.min(s_fi8, s_max_stirrup));
                results.stirrup_spacing_fi10 = Math.round(Math.min(s_fi10, s_max_stirrup));
                results.stirrup_spacing_max = Math.round(s_max_stirrup);

                // Ã–nerilen seÃ§im
                if (results.stirrup_spacing_fi10 >= 150) {
                    results.stirrup_recommendation = 'Î¦10 @' + results.stirrup_spacing_fi10 + 'mm (2 kollu)';
                } else if (results.stirrup_spacing_fi8 >= 100) {
                    results.stirrup_recommendation = 'Î¦8 @' + results.stirrup_spacing_fi8 + 'mm (2 kollu)';
                } else {
                    results.stirrup_recommendation = 'Î¦10 @150mm (2 kollu) - Minimum sÄ±klÄ±k';
                }
            } else {
                results.stirrup_recommendation = 'Etriye gerekli deÄŸil (V_d â‰¤ V_cr)';
                results.A_sw_s_required = 0;
                results.A_sw_s_required_mm2_m = 0;
            }

            // Ã‡atlak geniÅŸliÄŸi kontrolÃ¼ (TS 500 Madde 13.5)
            // Servis yÃ¼kÃ¼ altÄ±nda hesaplama (faktÃ¶rsÃ¼z yÃ¼kler)
            const M_s = geoResults.P_a * (geoResults.P_a_arm + inputs.TH) +
                        geoResults.P_q * (geoResults.P_q_arm + inputs.TH); // Servis momenti

            // Ã‡ekme bÃ¶lgesinde beton Ã§atlamÄ±ÅŸ kabul edilerek (Durum II)
            // BasitleÅŸtirilmiÅŸ Ã§atlak geniÅŸliÄŸi formÃ¼lÃ¼
            const E_s = 200000; // MPa (donatÄ± elastisite modÃ¼lÃ¼)
            const n = E_s / (5700 * Math.sqrt(fck)); // ModÃ¼ler oran

            // Etkili donatÄ± alanÄ±
            const A_s_eff = results.As_perde_tasarim; // mmÂ²/m

            // Ã‡ekme donatÄ±sÄ± gerilmesi (basitleÅŸtirilmiÅŸ)
            const x = d * (Math.sqrt(n * n * A_s_eff * A_s_eff / (1000 * d * 1000 * d) + 2 * n * A_s_eff / (1000 * d)) - n * A_s_eff / (1000 * d)); // TarafsÄ±z eksen derinliÄŸi (m)
            const I_cr = (1000 * Math.pow(x, 3) / 3) + n * A_s_eff * Math.pow(d - x, 2) / 1000000; // Ã‡atlamÄ±ÅŸ kesit atalet momenti (mâ´)
            const sigma_s = (M_s * (d - x) * n) / I_cr; // DonatÄ± gerilmesi (MPa)

            // Ã‡atlak aralÄ±ÄŸÄ±
            const c_cover = c_nom * 1000; // Ã–rtÃ¼ kalÄ±nlÄ±ÄŸÄ± (mm)
            const s_r_max = 2 * c_cover + 0.1 * fi_donati + (fi_donati / A_s_eff) * 1000; // mm (basitleÅŸtirilmiÅŸ)

            // Ortalama donatÄ± deformasyonu
            const eps_sm = Math.max(sigma_s / E_s - 0.4 * results.fctd / E_s, 0.6 * sigma_s / E_s);

            // Ã‡atlak geniÅŸliÄŸi (TS 500 Madde 13.5.2)
            const w_k = s_r_max * eps_sm; // mm

            results.w_k = w_k;
            results.sigma_s_servis = sigma_s;

            // Ã‡atlak geniÅŸliÄŸi limitleri (TS 500 Tablo 13.4)
            let w_k_max;
            if (inputs.cevre_sinifi === 'XC1') {
                w_k_max = 0.4; // mm
            } else if (['XC2', 'XC3', 'XC4'].includes(inputs.cevre_sinifi)) {
                w_k_max = 0.3; // mm (su geÃ§irimsizlik iÃ§in daha sÄ±kÄ±)
            } else {
                w_k_max = 0.2; // mm (klorÃ¼r ortamÄ±, deniz suyu - Ã§ok sÄ±kÄ±)
            }

            results.w_k_max = w_k_max;
            results.catlak_ok = w_k <= w_k_max;

            return results;
        }

        // Ä°kinci mertebe etkileri (P-Î”) hesabÄ±
        function calculateSecondOrderEffects(inputs, geoResults) {
            const results = {};

            // Perde yÃ¼ksekliÄŸi ve atalet momenti
            const H_perde = inputs.H - inputs.TH;
            const W_ort = (inputs.W_alt + inputs.W_ust) / 2;

            // Basit kesit atalet momenti (dikdÃ¶rtgen)
            const I = (1.0 * Math.pow(W_ort, 3)) / 12; // mâ´ (1m geniÅŸlik)

            // Elastisite modÃ¼lÃ¼ (beton)
            const E_c = 5700 * Math.sqrt(30); // MPa (C30 iÃ§in yaklaÅŸÄ±k)
            results.E_c = E_c;

            // Burkulma yÃ¼kÃ¼ (Euler)
            const P_cr = (Math.PI * Math.PI * E_c * I * 1000) / Math.pow(H_perde, 2); // kN

            // Eksenel yÃ¼k
            const N_Ed = geoResults.W_perde + geoResults.W_zemin; // kN/m

            // Narinlik oranÄ±
            const i = Math.sqrt(I / (W_ort * 1.0)); // Atalet yarÄ±Ã§apÄ± (m)
            const lambda = H_perde / i;
            results.lambda = lambda;

            // Ä°kinci mertebe moment bÃ¼yÃ¼tme faktÃ¶rÃ¼
            const beta = 1 / (1 - N_Ed / P_cr);
            results.beta = beta;
            results.P_cr = P_cr;
            results.N_Ed = N_Ed;

            // Narinlik kontrolÃ¼ (TS 500 Madde 11.7)
            // Î» > 25 ise ikinci mertebe etkileri dikkate alÄ±nmalÄ±
            results.ikinci_mertebe_gerekli = lambda > 25;

            if (lambda <= 25) {
                results.sonuc = 'KÄ±sa eleman - Ä°kinci mertebe etkileri ihmal edilebilir';
            } else {
                results.sonuc = 'Narin eleman - Ä°kinci mertebe etkileri Ã¶nemli (Î²=' + beta.toFixed(2) + ')';
            }

            return results;
        }

        // Zemin oturma hesabÄ±
        function calculateSettlement(inputs, geoResults, stabilityResults) {
            const results = {};

            // Efektif temel geniÅŸliÄŸi
            const B_eff = stabilityResults.bearing.B_eff;

            // Taban basÄ±ncÄ± (ortalama)
            const q_net = geoResults.V_total / inputs.B; // kN/mÂ² (net basÄ±nÃ§)
            results.q_net = q_net;

            // Elastik oturma (Terzaghi - basitleÅŸtirilmiÅŸ)
            // s_e = q * B * (1-Î½Â²) / E_s
            // E_s yaklaÅŸÄ±k tahmin (zemin parametrelerinden)
            const E_s = 2000 * (1 + inputs.phi / 10); // kPa (yaklaÅŸÄ±k - korelasyon)
            const nu = 0.3; // Poisson oranÄ± (ortalama)

            const s_elastic = (q_net * B_eff * (1 - nu * nu)) / E_s; // m
            results.s_elastic = s_elastic * 1000; // mm

            // Konsolidasyon oturmasÄ± (basitleÅŸtirilmiÅŸ - kil zeminler iÃ§in)
            // s_c = H * m_v * Î”Ïƒ (m_v: hacimsel sÄ±kÄ±ÅŸma katsayÄ±sÄ±)
            // Sadece bilgi amaÃ§lÄ±, kesin deÄŸil
            const m_v = 0.0005; // 1/kPa (ortalama deÄŸer, zemin etÃ¼dÃ¼nden alÄ±nmalÄ±)
            const H_compress = Math.min(inputs.H, 2.0); // SÄ±kÄ±ÅŸma bÃ¶lgesi kalÄ±nlÄ±ÄŸÄ± (yaklaÅŸÄ±k)

            const s_consolidation = H_compress * m_v * q_net; // m
            results.s_consolidation = s_consolidation * 1000; // mm

            // Toplam oturma
            const s_total = s_elastic + s_consolidation;
            results.s_total = s_total * 1000; // mm

            // Oturma limitleri (TS EN 1997-1)
            const s_max = 25; // mm (maksimum toplam oturma - yapÄ± tÃ¼rÃ¼ne gÃ¶re)
            results.s_max = s_max;
            results.oturma_ok = s_total * 1000 <= s_max;

            results.uyari = 'Not: Oturma hesabÄ± basitleÅŸtirilmiÅŸ. Zemin etÃ¼dÃ¼ gereklidir.';

            return results;
        }

        // SÄ±vÄ±laÅŸma riski kontrolÃ¼ (TBDY 2018 BÃ¶lÃ¼m 16.4)
        function calculateLiquefactionRisk(inputs) {
            const results = {};

            // SÄ±vÄ±laÅŸma potansiyeli deÄŸerlendirmesi
            // BasitleÅŸtirilmiÅŸ kontrol (detaylÄ± analiz zemin etÃ¼dÃ¼ ile yapÄ±lmalÄ±)

            // 1. Zemin sÄ±nÄ±fÄ± kontrolÃ¼
            const liquefiable_soils = ['ZD', 'ZE']; // GevÅŸek kumlar, yumuÅŸak killer
            results.zemin_risk = liquefiable_soils.includes(inputs.zemin_sinifi);

            // 2. Deprem ÅŸiddeti kontrolÃ¼
            results.deprem_risk = inputs.SDS > 0.5; // YÃ¼ksek sismik bÃ¶lge

            // 3. YeraltÄ± suyu varlÄ±ÄŸÄ± (kullanÄ±cÄ± giriÅŸi yok, varsayÄ±m)
            // U-kanal olduÄŸu iÃ§in su varlÄ±ÄŸÄ± yÃ¼ksek
            results.su_varligi = true;

            // Genel risk deÄŸerlendirmesi
            if (results.zemin_risk && results.deprem_risk && results.su_varligi) {
                results.risk_seviyesi = 'YÃœKSEK';
                results.renk = 'danger';
                results.oneri = 'DetaylÄ± sÄ±vÄ±laÅŸma analizi yapÄ±lmalÄ±! Zemin iyileÅŸtirmesi gerekebilir.';
            } else if ((results.zemin_risk && results.deprem_risk) ||
                       (results.zemin_risk && results.su_varligi) ||
                       (results.deprem_risk && results.su_varligi)) {
                results.risk_seviyesi = 'ORTA';
                results.renk = 'warning';
                results.oneri = 'SÄ±vÄ±laÅŸma potansiyeli deÄŸerlendirilmeli.';
            } else {
                results.risk_seviyesi = 'DÃœÅÃœK';
                results.renk = 'success';
                results.oneri = 'SÄ±vÄ±laÅŸma riski dÃ¼ÅŸÃ¼k.';
            }

            // TBDY 2018 Madde 16.4.2 kontrolÃ¼
            results.tbdy_madde = '16.4';
            results.uyari = 'Not: Kesin deÄŸerlendirme iÃ§in SPT veya CPT deneyleri gereklidir.';

            return results;
        }

        function generateSolutionSuggestions(inputs, stabilityResults, geoResults) {
            let html = '<div class="warning-box" style="margin-top: 20px;">';
            html += '<h4 style="color: #721c24; margin-bottom: 15px;">ğŸ”§ PROBLEM ANALÄ°ZÄ° VE Ã‡Ã–ZÃœM Ã–NERÄ°LERÄ°</h4>';
            
            const problems = [];
            const solutions = [];
            
            // STATÄ°K KONTROLLER
            if (!stabilityResults.devrilme_static_ok) {
                problems.push({
                    type: 'Devrilme (Statik)',
                    current: stabilityResults.GS_devrilme_static.toFixed(2),
                    required: '2.0',
                    severity: 'high'
                });
                
                const eksiklik = ((2.0 / stabilityResults.GS_devrilme_static) - 1) * 100;
                solutions.push({
                    problem: 'Devrilme GÃ¼venliÄŸi Yetersiz (Statik)',
                    icon: 'âš ï¸',
                    solutions: [
                        {
                            title: 'Temel GeniÅŸliÄŸini ArtÄ±r',
                            current: inputs.B.toFixed(2) + ' m',
                            suggested: (inputs.B * 1.2).toFixed(2) + ' m',
                            description: 'Temel geniÅŸliÄŸi yaklaÅŸÄ±k %' + eksiklik.toFixed(0) + ' artÄ±rÄ±lmalÄ±. Daha geniÅŸ temel, moment kolunu artÄ±rÄ±r.',
                            priority: 1,
                            effectiveness: 'YÃ¼ksek',
                            action: 'increase_B'
                        },
                        {
                            title: 'Topuk UzunluÄŸunu ArtÄ±r',
                            description: 'Topuk plaÄŸÄ±nÄ± uzatarak Ã¼zerindeki zemin aÄŸÄ±rlÄ±ÄŸÄ±nÄ± artÄ±rÄ±n.',
                            priority: 2,
                            effectiveness: 'YÃ¼ksek'
                        },
                        {
                            title: 'Perde KalÄ±nlÄ±ÄŸÄ±nÄ± Azalt',
                            current: inputs.W_alt.toFixed(2) + ' m',
                            suggested: Math.max(0.3, inputs.W_alt * 0.9).toFixed(2) + ' m',
                            description: 'Perde kalÄ±nlÄ±ÄŸÄ± azaltÄ±larak moment kolu iyileÅŸtirilebilir (minimum 30 cm).',
                            priority: 3,
                            effectiveness: 'Orta'
                        }
                    ]
                });
            }
            
            if (!stabilityResults.kayma_static_ok) {
                problems.push({
                    type: 'Kayma (Statik)',
                    current: stabilityResults.GS_kayma_static.toFixed(2),
                    required: '1.5',
                    severity: 'high'
                });
                
                const eksiklik = ((1.5 / stabilityResults.GS_kayma_static) - 1) * 100;
                solutions.push({
                    problem: 'Kayma GÃ¼venliÄŸi Yetersiz (Statik)',
                    icon: 'âš ï¸',
                    solutions: [
                        {
                            title: 'Temel GeniÅŸliÄŸini ArtÄ±r',
                            current: inputs.B.toFixed(2) + ' m',
                            suggested: (inputs.B * 1.15).toFixed(2) + ' m',
                            description: 'Daha geniÅŸ temel, daha fazla dÃ¼ÅŸey yÃ¼k ve dolayÄ±sÄ±yla daha fazla sÃ¼rtÃ¼nme direnci saÄŸlar.',
                            priority: 1,
                            effectiveness: 'YÃ¼ksek',
                            action: 'increase_B'
                        },
                        {
                            title: 'Temel DiÅŸ (Shear Key) Ekle',
                            description: 'Temel tabanÄ±na 40-60 cm derinliÄŸinde, 30-40 cm kalÄ±nlÄ±ÄŸÄ±nda pasif direnÃ§ diÅŸi ekleyin.',
                            priority: 1,
                            effectiveness: 'Ã‡ok YÃ¼ksek'
                        },
                        {
                            title: 'Zemini Ä°yileÅŸtir',
                            current: 'Ï† = ' + inputs.phi + 'Â°',
                            suggested: 'Ï† > ' + (inputs.phi + 5) + 'Â°',
                            description: 'Temel altÄ± zemini daha iyi drenajlÄ± malzeme ile deÄŸiÅŸtirin.',
                            priority: 2,
                            effectiveness: 'YÃ¼ksek'
                        }
                    ]
                });
            }
            
            if (!stabilityResults.eksantrisite_static_ok) {
                problems.push({
                    type: 'Eksantrisite (Statik)',
                    current: stabilityResults.e_B_orani_static.toFixed(3),
                    required: '< 0.167',
                    severity: 'medium'
                });
                
                solutions.push({
                    problem: 'Eksantrisite Limiti AÅŸÄ±ldÄ± (Statik)',
                    icon: 'âš¡',
                    solutions: [
                        {
                            title: 'Temeli Yeniden KonumlandÄ±r',
                            description: 'Temelin burun-topuk oranÄ±nÄ± deÄŸiÅŸtirerek bileÅŸke kuvvetin merkeze yaklaÅŸmasÄ±nÄ± saÄŸlayÄ±n.',
                            priority: 1,
                            effectiveness: 'YÃ¼ksek'
                        },
                        {
                            title: 'Temel GeniÅŸliÄŸini ArtÄ±r',
                            current: inputs.B.toFixed(2) + ' m',
                            suggested: (inputs.B * 1.1).toFixed(2) + ' m',
                            description: 'Daha geniÅŸ temel, aynÄ± eksantrisite iÃ§in daha dÃ¼ÅŸÃ¼k e/B oranÄ± verir.',
                            priority: 2,
                            effectiveness: 'Orta',
                            action: 'increase_B'
                        }
                    ]
                });
            }
            
            if (!stabilityResults.tasima_static_ok) {
                problems.push({
                    type: 'TaÅŸÄ±ma GÃ¼cÃ¼ (Statik)',
                    current: stabilityResults.GS_tasima_static.toFixed(2),
                    required: '2.5',
                    severity: 'high'
                });
                
                const eksiklik = ((2.5 / stabilityResults.GS_tasima_static) - 1) * 100;
                solutions.push({
                    problem: 'TaÅŸÄ±ma GÃ¼cÃ¼ Yetersiz (Statik)',
                    icon: 'ğŸš¨',
                    solutions: [
                        {
                            title: 'Temel GeniÅŸliÄŸini ArtÄ±r',
                            current: inputs.B.toFixed(2) + ' m',
                            suggested: (inputs.B * 1.2).toFixed(2) + ' m',
                            description: 'Daha geniÅŸ temel, temas gerilmesini azaltÄ±r (q = V/B).',
                            priority: 1,
                            effectiveness: 'Ã‡ok YÃ¼ksek',
                            action: 'increase_B'
                        },
                        {
                            title: 'Temel DerinliÄŸini ArtÄ±r',
                            description: 'Daha derin temelde zemin taÅŸÄ±ma gÃ¼cÃ¼ artar.',
                            priority: 2,
                            effectiveness: 'YÃ¼ksek'
                        },
                        {
                            title: 'Zemin Ä°yileÅŸtirmesi',
                            current: 'q_ult = ' + inputs.q_ult + ' kN/mÂ²',
                            suggested: 'q_ult > ' + (stabilityResults.q_max_static * 2.5).toFixed(0) + ' kN/mÂ²',
                            description: 'Zemin iyileÅŸtirme (jet grout, yer deÄŸiÅŸtirme, vb.) veya kazÄ±k sistemi dÃ¼ÅŸÃ¼nÃ¼n.',
                            priority: 3,
                            effectiveness: 'Ã‡ok YÃ¼ksek'
                        }
                    ]
                });
            }
            
            // DÄ°NAMÄ°K KONTROLLER
            if (!stabilityResults.devrilme_dynamic_ok) {
                problems.push({
                    type: 'Devrilme (Dinamik)',
                    current: stabilityResults.GS_devrilme_dynamic.toFixed(2),
                    required: '1.3',
                    severity: 'high'
                });
                
                solutions.push({
                    problem: 'Devrilme GÃ¼venliÄŸi Yetersiz (Deprem)',
                    icon: 'ğŸŒŠ',
                    solutions: [
                        {
                            title: 'Temel GeniÅŸliÄŸini ArtÄ±r',
                            current: inputs.B.toFixed(2) + ' m',
                            suggested: (inputs.B * 1.15).toFixed(2) + ' m',
                            description: 'Deprem durumunda karÅŸÄ± koyan momentleri artÄ±rÄ±r.',
                            priority: 1,
                            effectiveness: 'YÃ¼ksek',
                            action: 'increase_B'
                        },
                        {
                            title: 'Geri Dolgu AÄŸÄ±rlÄ±ÄŸÄ±nÄ± Azalt',
                            current: 'Î³ = ' + inputs.gamma_zemin + ' kN/mÂ³',
                            suggested: 'Î³ â‰ˆ ' + (inputs.gamma_zemin * 0.85).toFixed(1) + ' kN/mÂ³',
                            description: 'Hafif agrega veya geogrid kullanarak geri dolgu aÄŸÄ±rlÄ±ÄŸÄ±nÄ± azaltÄ±n.',
                            priority: 2,
                            effectiveness: 'Orta'
                        }
                    ]
                });
            }
            
            if (!stabilityResults.kayma_dynamic_ok) {
                problems.push({
                    type: 'Kayma (Dinamik)',
                    current: stabilityResults.GS_kayma_dynamic.toFixed(2),
                    required: '1.1',
                    severity: 'high'
                });
                
                solutions.push({
                    problem: 'Kayma GÃ¼venliÄŸi Yetersiz (Deprem)',
                    icon: 'ğŸŒŠ',
                    solutions: [
                        {
                            title: 'Temel DiÅŸ (Shear Key) Ekle - Ã–NEMLÄ°!',
                            description: 'Deprem durumunda kayma iÃ§in en etkili Ã§Ã¶zÃ¼m. 50-70 cm derinliÄŸinde temel diÅŸi ekleyin.',
                            priority: 1,
                            effectiveness: 'Ã‡ok YÃ¼ksek'
                        },
                        {
                            title: 'Temel GeniÅŸliÄŸini ArtÄ±r',
                            current: inputs.B.toFixed(2) + ' m',
                            suggested: (inputs.B * 1.1).toFixed(2) + ' m',
                            description: 'DÃ¼ÅŸey yÃ¼kÃ¼ ve sÃ¼rtÃ¼nme direncini artÄ±rÄ±r.',
                            priority: 2,
                            effectiveness: 'YÃ¼ksek',
                            action: 'increase_B'
                        }
                    ]
                });
            }
            
            // Problem Ã¶zeti tablosu
            if (problems.length > 0) {
                html += '<div class="table-container"><table style="margin-bottom: 20px;">';
                html += '<tr><th>Problem</th><th>Mevcut GS</th><th>Gerekli GS</th><th>Kritiklik</th></tr>';
                
                problems.forEach(p => {
                    const severityColor = p.severity === 'high' ? '#dc3545' : '#ffc107';
                    const severityText = p.severity === 'high' ? 'YÃ¼ksek' : 'Orta';
                    html += '<tr>';
                    html += '<td><strong>' + p.type + '</strong></td>';
                    html += '<td style="color: ' + severityColor + ';"><strong>' + p.current + '</strong></td>';
                    html += '<td>' + p.required + '</td>';
                    html += '<td style="color: ' + severityColor + ';"><strong>' + severityText + '</strong></td>';
                    html += '</tr>';
                });
                
                html += '</table></div>';
            }
            
            // Ã‡Ã¶zÃ¼m Ã¶nerileri
            if (solutions.length > 0) {
                html += '<h4 style="color: #721c24; margin: 20px 0 10px 0;">ğŸ’¡ Ã–nerilen Ã‡Ã¶zÃ¼mler (Ã–ncelik SÄ±rasÄ±na GÃ¶re)</h4>';
                
                solutions.forEach((sol, idx) => {
                    html += '<div style="background: white; padding: 15px; margin: 15px 0; border-radius: 8px; border-left: 4px solid #dc3545;">';
                    html += '<h5 style="color: #dc3545; margin-bottom: 10px;">' + sol.icon + ' ' + sol.problem + '</h5>';
                    
                    sol.solutions.forEach((s, sidx) => {
                        const priorityColor = s.priority === 1 ? '#dc3545' : s.priority === 2 ? '#ffc107' : '#17a2b8';
                        const priorityText = s.priority === 1 ? 'ğŸ”´ Ã–ncelik 1' : s.priority === 2 ? 'ğŸŸ¡ Ã–ncelik 2' : 'ğŸ”µ Ã–ncelik 3';
                        
                        html += '<div style="margin: 10px 0; padding: 10px; background: #f8f9fa; border-radius: 5px;">';
                        html += '<div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 8px;">';
                        html += '<strong style="color: #333;">' + (sidx + 1) + '. ' + s.title + '</strong>';
                        html += '<span style="background: ' + priorityColor + '; color: white; padding: 3px 8px; border-radius: 3px; font-size: 12px;">' + priorityText + '</span>';
                        html += '</div>';
                        
                        if (s.current) {
                            html += '<div style="margin: 5px 0; font-size: 14px;">';
                            html += '<span style="color: #666;">Mevcut: </span><strong>' + s.current + '</strong>';
                            html += ' â†’ <span style="color: #666;">Ã–nerilen: </span><strong style="color: #28a745;">' + s.suggested + '</strong>';
                            html += '</div>';
                        }
                        
                        html += '<div style="color: #555; font-size: 14px; margin-top: 5px;">' + s.description + '</div>';
                        html += '<div style="margin-top: 5px; font-size: 12px; color: #666;">Etkinlik: <strong>' + s.effectiveness + '</strong></div>';
                        
                        // Otomatik dÃ¼zelt butonu
                        if (s.action) {
                            html += '<button class="btn" style="margin-top: 10px; padding: 8px 16px; font-size: 14px;" onclick="autoFix(&quot;' + s.action + '&quot;, ' + s.suggested + ')">';
                            html += 'ğŸ”§ Bu DeÄŸeri Otomatik Uygula';
                            html += '</button>';
                        }
                        
                        html += '</div>';
                    });
                    
                    html += '</div>';
                });
            }
            
            // Genel Ã¶neriler
            html += '<div style="background: white; padding: 15px; margin: 15px 0; border-radius: 8px; border-left: 4px solid #17a2b8;">';
            html += '<h5 style="color: #17a2b8; margin-bottom: 10px;">ğŸ“Œ Genel Ã–neriler</h5>';
            html += '<ul style="margin: 10px 0; padding-left: 20px; color: #333;">';
            html += '<li>Birden fazla Ã§Ã¶zÃ¼mÃ¼ kombine ederek daha iyi sonuÃ§ alabilirsiniz</li>';
            html += '<li>Temel geniÅŸliÄŸini artÄ±rmak, Ã§oÄŸu sorunu Ã§Ã¶zen en efektif yÃ¶ntemdir</li>';
            html += '<li>Kayma problemlerinde mutlaka temel diÅŸi (shear key) kullanÄ±n</li>';
            html += '<li>DeÄŸiÅŸiklikleri yaptÄ±ktan sonra tÃ¼m hesaplamalarÄ± tekrar yapÄ±n</li>';
            html += '<li>Zemin ÅŸartlarÄ± kÃ¶tÃ¼yse, kazÄ±k veya zemin iyileÅŸtirmesi dÃ¼ÅŸÃ¼nÃ¼n</li>';
            html += '</ul>';
            html += '</div>';
            
            html += '</div>';
            return html;
        }

        function generateStructuralSolutions(inputs, structuralResults) {
            let html = '<div class="warning-box" style="margin-top: 20px;">';
            html += '<h4 style="color: #721c24;">ğŸ”§ YAPISAL TASARIM PROBLEMLERI VE Ã‡Ã–ZÃœMLERÄ°</h4>';
            
            if (!structuralResults.kesme_ok) {
                html += '<div style="background: white; padding: 15px; margin: 15px 0; border-radius: 8px; border-left: 4px solid #dc3545;">';
                html += '<h5 style="color: #dc3545; margin-bottom: 10px;">âš ï¸ Kesme Kapasitesi Yetersiz</h5>';
                
                const kesme_eksiklik = ((structuralResults.V_d_kesme / structuralResults.V_cr) - 1) * 100;
                html += '<p style="color: #666;">Mevcut kesme kuvveti, beton kesme dayanÄ±mÄ±nÄ± <strong>%' + kesme_eksiklik.toFixed(1) + '</strong> aÅŸÄ±yor.</p>';
                
                html += '<div style="margin: 10px 0; padding: 10px; background: #f8f9fa; border-radius: 5px;">';
                html += '<strong>1. Perde KalÄ±nlÄ±ÄŸÄ±nÄ± ArtÄ±r (En Efektif)</strong>';
                html += '<div style="margin: 5px 0; font-size: 14px;">';
                html += '<span style="color: #666;">Mevcut: </span><strong>' + inputs.W_alt + ' m</strong>';
                const suggested_W = inputs.W_alt * Math.sqrt(structuralResults.V_d_kesme / structuralResults.V_cr);
                html += ' â†’ <span style="color: #666;">Ã–nerilen: </span><strong style="color: #28a745;">' + suggested_W.toFixed(2) + ' m</strong>';
                html += '</div>';
                html += '<p style="color: #555; font-size: 14px;">Kesme dayanÄ±mÄ± kalÄ±nlÄ±kla doÄŸru orantÄ±lÄ±dÄ±r (V<sub>cr</sub> = 0.65 Ã— f<sub>ctd</sub> Ã— b<sub>w</sub> Ã— d)</p>';
                html += '<button class="btn" style="margin-top: 10px; padding: 8px 16px; font-size: 14px;" onclick="autoFixStructural(&quot;W_alt&quot;, ' + suggested_W.toFixed(2) + ')">';
                html += 'ğŸ”§ Bu DeÄŸeri Otomatik Uygula';
                html += '</button>';
                html += '</div>';
                
                html += '<div style="margin: 10px 0; padding: 10px; background: #f8f9fa; border-radius: 5px;">';
                html += '<strong>2. Etriye DonatÄ±sÄ± Ekle</strong>';
                html += '<p style="color: #555; font-size: 14px;">Î¦8 veya Î¦10 etriyeler, 15-20 cm aralÄ±klarla yerleÅŸtirilebilir.</p>';
                html += '<p style="color: #666; font-size: 13px;"><em>Not: TS 500 Â§8.5 - Etriye hesabÄ± iÃ§in ilave tasarÄ±m gereklidir.</em></p>';
                html += '</div>';
                
                html += '<div style="margin: 10px 0; padding: 10px; background: #f8f9fa; border-radius: 5px;">';
                html += '<strong>3. Beton SÄ±nÄ±fÄ±nÄ± YÃ¼kselt</strong>';
                html += '<div style="margin: 5px 0; font-size: 14px;">';
                html += '<span style="color: #666;">Mevcut: </span><strong>' + inputs.beton_sinifi + '</strong>';
                html += ' â†’ <span style="color: #666;">Ã–nerilen: </span><strong style="color: #28a745;">C35 veya C40</strong>';
                html += '</div>';
                html += '<p style="color: #555; font-size: 14px;">Daha yÃ¼ksek beton sÄ±nÄ±fÄ±, f<sub>ctd</sub> deÄŸerini artÄ±rÄ±r.</p>';
                html += '</div>';
                
                html += '</div>';
            }
            
            if (!structuralResults.aralÄ±k_ok) {
                html += '<div style="background: white; padding: 15px; margin: 15px 0; border-radius: 8px; border-left: 4px solid #ffc107;">';
                html += '<h5 style="color: #856404; margin-bottom: 10px;">âš¡ DonatÄ± AralÄ±ÄŸÄ± Fazla</h5>';
                
                html += '<p style="color: #666;">Hesaplanan donatÄ± aralÄ±ÄŸÄ± (<strong>' + structuralResults.donati_araligi + ' mm</strong>), maksimum izin verilen aralÄ±ÄŸÄ± (<strong>' + structuralResults.s_max.toFixed(0) + ' mm</strong>) aÅŸÄ±yor.</p>';
                
                html += '<div style="margin: 10px 0; padding: 10px; background: #fff3cd; border-radius: 5px;">';
                html += '<strong>Ã‡Ã¶zÃ¼m: DonatÄ± Ã‡apÄ±nÄ± ArtÄ±r</strong>';
                html += '<div style="margin: 5px 0; font-size: 14px;">';
                html += '<span style="color: #666;">Mevcut: </span><strong>Î¦16</strong>';
                html += ' â†’ <span style="color: #666;">Ã–nerilen: </span><strong style="color: #dc3545;">Î¦18 veya Î¦20</strong>';
                html += '</div>';
                html += '<p style="color: #555; font-size: 14px;">Daha bÃ¼yÃ¼k Ã§ap, aynÄ± A<sub>s</sub> iÃ§in daha az adet demirle Ã§alÄ±ÅŸmanÄ±za olanak verir.</p>';
                html += '<ul style="margin: 10px 0; padding-left: 20px; font-size: 13px; color: #666;">';
                html += '<li>Î¦18 kullanÄ±mÄ±nda: AralÄ±k â‰ˆ ' + (structuralResults.donati_araligi * (18*18)/(16*16)).toFixed(0) + ' mm</li>';
                html += '<li>Î¦20 kullanÄ±mÄ±nda: AralÄ±k â‰ˆ ' + (structuralResults.donati_araligi * (20*20)/(16*16)).toFixed(0) + ' mm</li>';
                html += '</ul>';
                html += '</div>';
                
                html += '</div>';
            }
            
            html += '<div style="background: white; padding: 15px; margin: 15px 0; border-radius: 8px; border-left: 4px solid #17a2b8;">';
            html += '<h5 style="color: #17a2b8; margin-bottom: 10px;">ğŸ“Œ TS 500 Ã–nemli HatÄ±rlatmalar</h5>';
            html += '<ul style="margin: 10px 0; padding-left: 20px; color: #333;">';
            html += '<li>Minimum duvar kalÄ±nlÄ±ÄŸÄ±: 150 mm (tercihan â‰¥ 200 mm)</li>';
            html += '<li>Beton Ã¶rtÃ¼sÃ¼: Minimum 40 mm (zemin temasÄ± olan yerlerde 50 mm)</li>';
            html += '<li>Minimum donatÄ± oranÄ±: Her iki yÃ¼zde toplam 0.0025A<sub>g</sub></li>';
            html += '<li>Maksimum donatÄ± aralÄ±ÄŸÄ±: Min(300 mm, 1.5Ã—kalÄ±nlÄ±k)</li>';
            html += '<li>KÃ¶ÅŸe ve derz bÃ¶lgelerinde ek donatÄ± gerekir</li>';
            html += '</ul>';
            html += '</div>';
            
            html += '</div>';
            return html;
        }

        function autoFixStructural(param, value) {
            if (param === 'W_alt') {
                document.getElementById('W_alt').value = value;
                // W_ust'u de orantÄ±lÄ± artÄ±r
                const ratio = value / parseFloat(document.getElementById('W_alt').value);
                const newWust = parseFloat(document.getElementById('W_ust').value) * ratio;
                document.getElementById('W_ust').value = Math.max(0.3, newWust).toFixed(2);
                
                alert('âœ“ Perde kalÄ±nlÄ±klarÄ± gÃ¼ncellendi:\n' +
                      '  â€¢ Alt kalÄ±nlÄ±k: ' + value + ' m\n' +
                      '  â€¢ Ãœst kalÄ±nlÄ±k: ' + Math.max(0.3, newWust).toFixed(2) + ' m\n\n' +
                      'Åimdi "TÃ¼m HesaplamalarÄ± Yap" butonuna tÄ±klayÄ±n.');
            }
        }

        function autoFix(action, value) {
            if (action === 'increase_B') {
                document.getElementById('B').value = value;
                alert('âœ“ Temel geniÅŸliÄŸi ' + value + ' m olarak gÃ¼ncellendi.\n\nÅimdi "TÃ¼m HesaplamalarÄ± Yap" butonuna tÄ±klayarak yeniden hesaplayÄ±n.');
            }
        }

        function calculateMetraj(inputs) {
            const results = {};
            
            // Beton metrajÄ±
            const H_perde = inputs.H - inputs.TH;
            const W_ort = (inputs.W_alt + inputs.W_ust) / 2;
            
            // Temel
            results.V_temel = inputs.L * inputs.B * inputs.TH;
            
            // Perde
            results.V_perde = inputs.L * W_ort * H_perde;
            
            // Toplam beton (C30)
            results.V_beton_toplam = results.V_temel + results.V_perde;
            
            // Grobeton (10cm)
            results.V_grobeton = inputs.L * inputs.B * 0.1;
            
            // KalÄ±p metrajÄ±
            // Temel kalÄ±bÄ±
            results.A_kalip_temel = 2 * inputs.L * inputs.TH + 
                                   2 * inputs.B * inputs.TH;
            
            // Perde kalÄ±bÄ± (iki yÃ¼z)
            results.A_kalip_perde = 2 * inputs.L * H_perde;
            
            // Toplam kalÄ±p
            results.A_kalip_toplam = results.A_kalip_temel + results.A_kalip_perde;
            
            // DonatÄ± metrajÄ± (basitleÅŸtirilmiÅŸ)
            // DÃ¼ÅŸey donatÄ± (perde)
            const n_dus = Math.ceil(inputs.L * 1000 / 150); // 15cm aralÄ±kla
            const L_dus_bir = H_perde + 0.4 + 0.4; // Ankraj uzunluklarÄ±
            results.L_donati_dusey = n_dus * L_dus_bir * 2; // Ä°ki yÃ¼z
            
            // Yatay donatÄ± (perde)
            const n_yat = Math.ceil(H_perde * 1000 / 200); // 20cm aralÄ±kla
            const L_yat_bir = inputs.L + 0.4 + 0.4; // Ankraj
            results.L_donati_yatay = n_yat * L_yat_bir * 2;
            
            // Temel donatÄ±sÄ±
            const n_temel_ust = Math.ceil(inputs.L * 1000 / 150);
            const n_temel_alt = Math.ceil(inputs.B * 1000 / 150);
            results.L_donati_temel = (n_temel_ust * (inputs.B + 0.8) + 
                                     n_temel_alt * (inputs.L + 0.8)) * 2;
            
            // Toplam donatÄ± uzunluÄŸu
            results.L_donati_toplam = results.L_donati_dusey + 
                                     results.L_donati_yatay + 
                                     results.L_donati_temel;
            
            // DonatÄ± aÄŸÄ±rlÄ±ÄŸÄ± (Î¦16 iÃ§in 1.578 kg/m)
            results.W_donati = results.L_donati_toplam * 1.578 / 1000; // ton
            
            return results;
        }

        function displayResults() {
            const inputs = getInputValues();

            // Hidrolik hesaplar
            const hydResults = calculateHydraulics(inputs);
            calculationResults.hydraulics = hydResults;

            // NaN deÄŸerlerini temizle
            const cleanResults = (obj) => {
                for (let key in obj) {
                    if (typeof obj[key] === 'number' && isNaN(obj[key])) {
                        obj[key] = 0;
                    }
                }
                return obj;
            };
            cleanResults(hydResults);

            let html = '<div class="formula-box"><strong>Manning Denklemi:</strong> V = (1/n) Ã— R<sub>h</sub><sup>2/3</sup> Ã— S<sub>o</sub><sup>1/2</sup></div>';

            // NaN kontrolÃ¼ ile gÃ¼venli gÃ¶sterim
            const formatValue = (value, decimals = 2) => {
                if (isNaN(value) || value === undefined || value === null) {
                    return '--';
                }
                return value.toFixed(decimals);
            };

            html += '<div class="result-item"><span class="result-label">Su DerinliÄŸi (h<sub>su</sub>)</span><span class="result-value">' + formatValue(hydResults.h_su, 2) + ' m</span></div>';
            html += '<div class="result-item"><span class="result-label">AkÄ±m HÄ±zÄ± (V)</span><span class="result-value">' + formatValue(hydResults.V, 2) + ' m/sn</span></div>';
            html += '<div class="result-item"><span class="result-label">AkÄ±m AlanÄ± (A)</span><span class="result-value">' + formatValue(hydResults.A, 2) + ' mÂ²</span></div>';
            html += '<div class="result-item"><span class="result-label">Hidrolik YarÄ±Ã§ap (R<sub>h</sub>)</span><span class="result-value">' + formatValue(hydResults.R_h, 3) + ' m</span></div>';
            html += '<div class="result-item"><span class="result-label">Islak Ã‡evre (P)</span><span class="result-value">' + formatValue(hydResults.P, 2) + ' m</span></div>';
            html += '<div class="result-item"><span class="result-label">Hava PayÄ± (H<sub>p</sub>)</span><span class="result-value">' + formatValue(hydResults.H_p, 2) + ' m</span></div>';
            html += '<div class="result-item"><span class="result-label">Hidrolik YÃ¼kseklik (H<sub>h</sub>)</span><span class="result-value">' + formatValue(hydResults.H_h, 2) + ' m</span></div>';
            html += '<div class="result-item"><span class="result-label">Froude SayÄ±sÄ± (Fr)</span><span class="result-value">' + formatValue(hydResults.Fr, 3) + '</span></div>';
            html += '<div class="result-item"><span class="result-label">AkÄ±m Tipi</span><span class="result-value ' + (hydResults.Fr < 1 ? 'success' : 'warning') + '">' + (hydResults.flow_type || 'HesaplanamadÄ±') + '</span></div>';
            html += '<div class="formula-box"><strong>Hidrostatik BasÄ±nÃ§:</strong> P<sub>w</sub> = (1/2) Ã— Î³<sub>w</sub> Ã— h<sub>su</sub>Â²</div>';
            html += '<div class="result-item"><span class="result-label">Hidrostatik BasÄ±nÃ§ (P<sub>w</sub>)</span><span class="result-value">' + formatValue(hydResults.P_w, 2) + ' kN/mÂ²</span></div>';
            
            // Hidrolik uyarÄ±lar ve Ã¶neriler
            if (hydResults.Fr > 1.2) {
                html += '<div class="warning-box" style="margin-top: 20px;">';
                html += '<h5 style="color: #856404;">âš ï¸ YÃ¼ksek HÄ±zlÄ± AkÄ±m UyarÄ±sÄ±</h5>';
                html += '<p>Froude sayÄ±sÄ± ' + hydResults.Fr.toFixed(2) + ' > 1.0 (Kritik Ã¼stÃ¼ akÄ±m)</p>';
                html += '<strong>Riskler:</strong>';
                html += '<ul style="margin: 10px 0; padding-left: 20px;">';
                html += '<li>Kanal tabanÄ±nda aÅŸÄ±nma ve kavitasyon riski</li>';
                html += '<li>Hidrolik sÄ±Ã§rama olasÄ±lÄ±ÄŸÄ±</li>';
                html += '<li>Enerji kÄ±rÄ±cÄ± gerekebilir</li>';
                html += '</ul>';
                html += '<strong>Ã–neriler:</strong>';
                html += '<ul style="margin: 10px 0; padding-left: 20px; color: #28a745;">';
                html += '<li>Kanal eÄŸimini azaltÄ±n (mevcut: ' + inputs.So + ')</li>';
                html += '<li>Kanal geniÅŸliÄŸini artÄ±rÄ±n (mevcut: ' + inputs.b + ' m â†’ Ã¶nerilen: ' + (inputs.b * 1.2).toFixed(2) + ' m)</li>';
                html += '<li>BasamaklÄ± kanal (stepped channel) dÃ¼ÅŸÃ¼nÃ¼n</li>';
                html += '<li>Enerji kÄ±rÄ±cÄ± yapÄ±lar ekleyin</li>';
                html += '</ul>';
                html += '</div>';
            } else if (hydResults.Fr < 0.5) {
                html += '<div class="info-box" style="margin-top: 20px;">';
                html += '<h5 style="color: #0c5460;">ğŸ’¡ Ã‡ok YavaÅŸ AkÄ±m</h5>';
                html += '<p>Froude sayÄ±sÄ± ' + hydResults.Fr.toFixed(2) + ' < 0.5 (Ã‡ok sakin akÄ±m)</p>';
                html += '<strong>DeÄŸerlendirme:</strong>';
                html += '<ul style="margin: 10px 0; padding-left: 20px;">';
                html += '<li>AkÄ±m gÃ¼venli ancak kanal verimsiz olabilir</li>';
                html += '<li>Sediment birikme riski artar</li>';
                html += '<li>Daha kÃ¼Ã§Ã¼k kesit yeterli olabilir</li>';
                html += '</ul>';
                html += '<strong>Ã–neriler:</strong>';
                html += '<ul style="margin: 10px 0; padding-left: 20px; color: #17a2b8;">';
                html += '<li>Kanal geniÅŸliÄŸini azaltabilirsiniz (mevcut: ' + inputs.b + ' m â†’ Ã¶nerilen: ' + (inputs.b * 0.85).toFixed(2) + ' m)</li>';
                html += '<li>Kanal eÄŸimini artÄ±rabilirsiniz (ekonomik tasarÄ±m iÃ§in)</li>';
                html += '<li>Periyodik temizlik planÄ± yapÄ±n (sediment kontrolÃ¼)</li>';
                html += '</ul>';
                html += '</div>';
            }
            
            if (hydResults.h_su / inputs.b > 1.5) {
                html += '<div class="warning-box" style="margin-top: 20px;">';
                html += '<h5 style="color: #856404;">âš ï¸ Derinlik/GeniÅŸlik OranÄ± YÃ¼ksek</h5>';
                html += '<p>h/b oranÄ± = ' + (hydResults.h_su / inputs.b).toFixed(2) + ' > 1.5</p>';
                html += '<strong>Problem:</strong> Dar ve derin kanal, yapÄ±m zorluÄŸu ve maliyet artÄ±ÅŸÄ±na neden olur.';
                html += '<br><strong>Ã–neri:</strong> Kanal geniÅŸliÄŸini ' + (hydResults.h_su / 1.0).toFixed(2) + ' m\'ye artÄ±rÄ±n (h/b â‰ˆ 1.0 ideal).';
                html += '</div>';
            }
            
            // Hava payÄ± kontrolÃ¼
            if (hydResults.H_p < 0.5) {
                html += '<div class="info-box" style="margin-top: 20px;">';
                html += '<h5 style="color: #0c5460;">ğŸ’¡ Hava PayÄ± Ã–nerisi</h5>';
                html += '<p>Hesaplanan hava payÄ±: ' + hydResults.H_p.toFixed(2) + ' m</p>';
                html += '<p>Meskun mahalde yapÄ±lan kanallar iÃ§in en az <strong>0.50 m</strong> hava payÄ± Ã¶nerilir.</p>';
                html += '<p style="color: #28a745;">Ã–nerilen toplam kanal yÃ¼ksekliÄŸi: ' + (hydResults.h_su + 0.5).toFixed(2) + ' m</p>';
                html += '</div>';
            }
            
            document.getElementById('hidrolik-sonuc').innerHTML = html;
            
            // Geoteknik hesaplar
            const geoResults = calculateGeotechnics(inputs);
            calculationResults.geotechnics = geoResults;
            cleanResults(geoResults);
            
            html = '<div class="formula-box"><strong>Rankine Teorisi:</strong> K<sub>a</sub> = tanÂ²(45Â° - Ï†/2), K<sub>p</sub> = tanÂ²(45Â° + Ï†/2)</div>';
            html += '<div class="result-item"><span class="result-label">Aktif Toprak BasÄ±ncÄ± KatsayÄ±sÄ± (K<sub>a</sub>)</span><span class="result-value">' + geoResults.K_a.toFixed(3) + '</span></div>';
            html += '<div class="result-item"><span class="result-label">Pasif Toprak BasÄ±ncÄ± KatsayÄ±sÄ± (K<sub>p</sub>)</span><span class="result-value">' + geoResults.K_p.toFixed(3) + '</span></div>';
            html += '<div class="formula-box"><strong>Statik Aktif Ä°tki:</strong> P<sub>a</sub> = (1/2) Ã— Î³ Ã— HÂ² Ã— K<sub>a</sub></div>';
            html += '<div class="result-item"><span class="result-label">Statik Aktif Toprak Ä°tkisi (P<sub>a</sub>)</span><span class="result-value">' + geoResults.P_a.toFixed(2) + ' kN/m</span></div>';
            html += '<div class="result-item"><span class="result-label">P<sub>a</sub> Etkime Kolu</span><span class="result-value">' + geoResults.P_a_arm.toFixed(2) + ' m (H/3)</span></div>';
            html += '<div class="formula-box"><strong>SÃ¼rÅŸarj Ä°tkisi:</strong> P<sub>q</sub> = q Ã— H Ã— K<sub>a</sub></div>';
            html += '<div class="result-item"><span class="result-label">SÃ¼rÅŸarj Ä°tkisi (P<sub>q</sub>)</span><span class="result-value">' + geoResults.P_q.toFixed(2) + ' kN/m</span></div>';
            html += '<div class="result-item"><span class="result-label">P<sub>q</sub> Etkime Kolu</span><span class="result-value">' + geoResults.P_q_arm.toFixed(2) + ' m (H/2)</span></div>';
            html += '<div class="result-item"><span class="result-label"><strong>Toplam Yatay Ä°tki (Statik)</strong></span><span class="result-value success">' + geoResults.P_h_static.toFixed(2) + ' kN/m</span></div>';
            
            html += '<h4 style="margin-top: 20px; color: #2a5298;">AÄŸÄ±rlÄ±k HesaplarÄ±</h4>';
            html += '<div class="result-item"><span class="result-label">Temel AÄŸÄ±rlÄ±ÄŸÄ± (W<sub>temel</sub>)</span><span class="result-value">' + geoResults.W_temel.toFixed(2) + ' kN/m</span></div>';
            html += '<div class="result-item"><span class="result-label">Perde AÄŸÄ±rlÄ±ÄŸÄ± (W<sub>perde</sub>)</span><span class="result-value">' + geoResults.W_perde.toFixed(2) + ' kN/m</span></div>';
            html += '<div class="result-item"><span class="result-label">Zemin Dolgusunun AÄŸÄ±rlÄ±ÄŸÄ± (W<sub>zemin</sub>)</span><span class="result-value">' + geoResults.W_zemin.toFixed(2) + ' kN/m</span></div>';
            html += '<div class="result-item"><span class="result-label"><strong>Toplam DÃ¼ÅŸey YÃ¼k (Î£V)</strong></span><span class="result-value success">' + geoResults.V_total.toFixed(2) + ' kN/m</span></div>';
            
            // Zemin uyarÄ±larÄ± ve Ã¶nerileri
            if (inputs.phi < 28) {
                html += '<div class="warning-box" style="margin-top: 20px;">';
                html += '<h5 style="color: #721c24;">ğŸš¨ DÃ¼ÅŸÃ¼k Ä°Ã§sel SÃ¼rtÃ¼nme AÃ§Ä±sÄ±</h5>';
                html += '<p>Zemin sÃ¼rtÃ¼nme aÃ§Ä±sÄ± Ï† = ' + inputs.phi + 'Â° < 28Â° (ZayÄ±f zemin)</p>';
                html += '<strong>Riskler:</strong>';
                html += '<ul style="margin: 10px 0; padding-left: 20px;">';
                html += '<li>YÃ¼ksek aktif toprak basÄ±ncÄ± (K<sub>a</sub> = ' + geoResults.K_a.toFixed(3) + ')</li>';
                html += '<li>Stabilite problemleri olasÄ±lÄ±ÄŸÄ± yÃ¼ksek</li>';
                html += '<li>Oturma ve deformasyon riski</li>';
                html += '</ul>';
                html += '<strong>Ã–nerilen Ã‡Ã¶zÃ¼mler:</strong>';
                html += '<ul style="margin: 10px 0; padding-left: 20px; color: #28a745;">';
                html += '<li><strong>1. Ã–ncelik:</strong> Geri dolgu malzemesini deÄŸiÅŸtirin (GW, SW - Ï† > 32Â°)</li>';
                html += '<li><strong>2. Ã–ncelik:</strong> Zemin iyileÅŸtirmesi yapÄ±n (kompaksiyon, yer deÄŸiÅŸtirme)</li>';
                html += '<li><strong>3. Ã–ncelik:</strong> Geogrid takviyeli dolgu kullanÄ±n</li>';
                html += '<li>Alternatif: KazÄ±k veya jet-grout ile zemin gÃ¼Ã§lendirme</li>';
                html += '</ul>';
                html += '</div>';
            }
            
            if (inputs.c > 0) {
                html += '<div class="info-box" style="margin-top: 20px;">';
                html += '<h5 style="color: #0c5460;">ğŸ’¡ Kohezyon DeÄŸeri HakkÄ±nda</h5>';
                html += '<p>Girilen kohezyon: c = ' + inputs.c + ' kPa</p>';
                html += '<p><strong>Ã–nemli:</strong> Ä°stinat duvarÄ± tasarÄ±mÄ±nda genellikle c = 0 alÄ±nÄ±r (gÃ¼venli taraf). Kohezyonlu zeminler (kil) zamana baÄŸlÄ± dayanÄ±m kaybÄ± gÃ¶sterebilir.</p>';
                html += '<p style="color: #dc3545;"><strong>Ã–neri:</strong> Uzun dÃ¶nem stabilitesi iÃ§in c = 0 kabul edin ve hesaplarÄ± tekrarlayÄ±n.</p>';
                html += '</div>';
            }
            
            if (geoResults.K_a > 0.4) {
                html += '<div class="warning-box" style="margin-top: 20px;">';
                html += '<h5 style="color: #856404;">âš ï¸ YÃ¼ksek Aktif BasÄ±nÃ§ KatsayÄ±sÄ±</h5>';
                html += '<p>K<sub>a</sub> = ' + geoResults.K_a.toFixed(3) + ' > 0.40</p>';
                html += '<p>Zemin, duvara yÃ¼ksek yatay itki uygulayacaktÄ±r.</p>';
                html += '<strong>Ã–neriler:</strong>';
                html += '<ul style="margin: 10px 0; padding-left: 20px;">';
                html += '<li>Daha kaliteli geri dolgu malzemesi kullanÄ±n (Ï† > 32Â°)</li>';
                html += '<li>Duvar geometrisini gÃ¼Ã§lendirin (temel geniÅŸliÄŸi, perde kalÄ±nlÄ±ÄŸÄ±)</li>';
                html += '<li>Geogrid veya geotekstil takviye dÃ¼ÅŸÃ¼nÃ¼n</li>';
                html += '</ul>';
                html += '</div>';
            }
            
            // Pasif direnÃ§ uyarÄ±sÄ±
            html += '<div class="info-box" style="margin-top: 20px;">';
            html += '<h5 style="color: #17a2b8;">ğŸ“Œ Pasif Toprak Direnci (K<sub>p</sub> = ' + geoResults.K_p.toFixed(2) + ')</h5>';
            html += '<p>Pasif direnÃ§, kayma gÃ¼venliÄŸini artÄ±rmak iÃ§in kullanÄ±labilir, ancak:</p>';
            html += '<ul style="margin: 5px 0; padding-left: 20px; color: #666;">';
            html += '<li>Temel Ã¶nÃ¼ndeki dolgunun kalÄ±cÄ± olduÄŸundan emin olun</li>';
            html += '<li>KazÄ± veya erozyon riski varsa pasif direnci hesaba katmayÄ±n</li>';
            html += '<li>GÃ¼venlik iÃ§in pasif direncin %50\'sini kullanÄ±n (Terzaghi Ã¶nerisi)</li>';
            html += '</ul>';
            html += '</div>';
            
            document.getElementById('geoteknik-sonuc').innerHTML = html;
            
            // Deprem hesaplarÄ±
            const seismicResults = calculateSeismic(inputs, geoResults);
            calculationResults.seismic = seismicResults;
            cleanResults(seismicResults);
            
            html = '<div class="info-box"><strong>TBDY 2018 Pseudo-Statik YaklaÅŸÄ±m (Tam Mononobe-Okabe)</strong></div>';
            
            html += '<h4 style="color: #2a5298; margin-top: 15px;">Zemin SÄ±nÄ±fÄ± Etkisi (TBDY 2018 Tablo 16.1)</h4>';
            html += '<div class="result-item"><span class="result-label">Zemin SÄ±nÄ±fÄ±</span><span class="result-value">' + inputs.zemin_sinifi + '</span></div>';
            html += '<div class="result-item"><span class="result-label">Zemin KatsayÄ±sÄ± (F<sub>s</sub>)</span><span class="result-value">' + seismicResults.F_s.toFixed(2) + '</span></div>';
            html += '<div class="result-item"><span class="result-label">S<sub>DS</sub> (Harita)</span><span class="result-value">' + inputs.SDS.toFixed(3) + ' g</span></div>';
            html += '<div class="result-item"><span class="result-label">S<sub>DS,zemin</sub> (DÃ¼zeltilmiÅŸ)</span><span class="result-value warning">' + seismicResults.S_DS_zemin.toFixed(3) + ' g</span></div>';
            
            html += '<h4 style="color: #2a5298; margin-top: 15px;">Deprem KatsayÄ±larÄ±</h4>';
            html += '<div class="formula-box"><strong>Yatay:</strong> k<sub>h</sub> = 0.4 Ã— (S<sub>DS,zemin</sub>/r)<br><strong>DÃ¼ÅŸey:</strong> k<sub>v</sub> = (2/3) Ã— k<sub>h</sub></div>';
            html += '<div class="result-item"><span class="result-label">Yatay Deprem KatsayÄ±sÄ± (k<sub>h</sub>)</span><span class="result-value">' + seismicResults.k_h.toFixed(3) + '</span></div>';
            html += '<div class="result-item"><span class="result-label">DÃ¼ÅŸey Deprem KatsayÄ±sÄ± (k<sub>v</sub>)</span><span class="result-value">' + seismicResults.k_v.toFixed(3) + '</span></div>';
            html += '<div class="result-item"><span class="result-label">Î¸ (SÃ¶zde-yatay aÃ§Ä±)</span><span class="result-value">' + seismicResults.theta.toFixed(2) + 'Â°</span></div>';
            
            html += '<h4 style="color: #2a5298; margin-top: 15px;">Dinamik BasÄ±nÃ§</h4>';
            html += '<div class="result-item"><span class="result-label">Dinamik Aktif BasÄ±nÃ§ KatsayÄ±sÄ± (K<sub>ae</sub>)</span><span class="result-value">' + seismicResults.K_ae.toFixed(3) + '</span></div>';
            html += '<div class="result-item"><span class="result-label">k<sub>v</sub> Durumu</span><span class="result-value">' + seismicResults.kv_durum + '</span></div>';
            html += '<div class="formula-box"><strong>Toplam Dinamik Ä°tki (TBDY 16.23):</strong> P<sub>t</sub> = K<sub>ae</sub> Ã— (1Â±k<sub>v</sub>) Ã— [(1/2)Î³HÂ² + qH]</div>';
            html += '<div class="result-item"><span class="result-label">Toplam Dinamik Ä°tki (P<sub>t</sub>)</span><span class="result-value warning">' + seismicResults.P_t.toFixed(2) + ' kN/m</span></div>';
            html += '<div class="result-item"><span class="result-label">Dinamik Ä°tki ArtÄ±ÅŸÄ± (Î”P)</span><span class="result-value danger">' + seismicResults.Delta_P.toFixed(2) + ' kN/m</span></div>';
            html += '<div class="result-item"><span class="result-label">P<sub>t</sub> Etkime Kolu</span><span class="result-value">' + seismicResults.P_t_arm.toFixed(2) + ' m (H/2)</span></div>';
            
            const artis_yuzdesi = ((seismicResults.P_t - geoResults.P_h_static) / geoResults.P_h_static * 100).toFixed(1);
            html += '<div class="warning-box">âš ï¸ Deprem etkisiyle yatay itki <strong>%' + artis_yuzdesi + '</strong> artmÄ±ÅŸtÄ±r.</div>';
            
            // Deprem tasarÄ±m Ã¶nerileri
            if (seismicResults.k_h > 0.25) {
                html += '<div class="warning-box" style="margin-top: 20px;">';
                html += '<h5 style="color: #721c24;">ğŸŒŠ YÃ¼ksek Sismik YÃ¼k BÃ¶lgesi</h5>';
                html += '<p>Yatay deprem katsayÄ±sÄ± k<sub>h</sub> = ' + seismicResults.k_h.toFixed(3) + ' > 0.25</p>';
                html += '<p>Proje yÃ¼ksek deprem riski olan bir bÃ¶lgede bulunmaktadÄ±r.</p>';
                html += '<strong>Ã–zel Ã–nlemler:</strong>';
                html += '<ul style="margin: 10px 0; padding-left: 20px;">';
                html += '<li><strong>Drenaj sistemi kritik:</strong> Su basÄ±ncÄ± deprem itkisini %50-80 artÄ±rabilir</li>';
                html += '<li><strong>Temel diÅŸi zorunlu:</strong> Kayma gÃ¼venliÄŸi iÃ§in mutlaka shear key ekleyin</li>';
                html += '<li><strong>Geri dolgu:</strong> Hafif malzeme (EPS geofom, agrega) kullanÄ±n</li>';
                html += '<li><strong>Geogrid takviye:</strong> 50-80 cm aralÄ±klarla geogrid ÅŸeritler yerleÅŸtirin</li>';
                html += '<li><strong>Deformasyon derzleri:</strong> 5-7 m aralÄ±klarla derz bÄ±rakÄ±n</li>';
                html += '<li><strong>Alternatif:</strong> Betonarme L-duvar veya ankrajlÄ± duvar dÃ¼ÅŸÃ¼nÃ¼n</li>';
                html += '</ul>';
                html += '</div>';
            }
            
            if (inputs.SDS > 1.0) {
                html += '<div class="warning-box" style="margin-top: 20px;">';
                html += '<h5 style="color: #721c24;">ğŸš¨ Ã‡ok YÃ¼ksek Deprem Riski</h5>';
                html += '<p>S<sub>DS</sub> = ' + inputs.SDS + ' g > 1.0 (DD-1 deprem bÃ¶lgesi)</p>';
                html += '<strong>Kritik Ã–neriler:</strong>';
                html += '<ul style="margin: 10px 0; padding-left: 20px; color: #dc3545;">';
                html += '<li>YapÄ±-zemin etkileÅŸimi analizi yapÄ±lmalÄ±</li>';
                html += '<li>Dinamik analiz (zaman tanÄ±m alanÄ±nda) tercih edilmeli</li>';
                html += '<li>SÄ±vÄ±laÅŸma potansiyeli mutlaka araÅŸtÄ±rÄ±lmalÄ±</li>';
                html += '<li>AnkrajlÄ± veya kazÄ±klÄ± sistem dÃ¼ÅŸÃ¼nÃ¼lmeli</li>';
                html += '</ul>';
                html += '</div>';
            }
            
            html += '<div class="info-box" style="margin-top: 20px;">';
            html += '<h5 style="color: #0c5460;">ğŸ“Œ TBDY 2018 Ã–nemli Notlar</h5>';
            html += '<ul style="margin: 5px 0; padding-left: 20px;">';
            html += '<li>Azaltma katsayÄ±sÄ± r = ' + inputs.r + ' (Konsol duvarlar iÃ§in 1.5-2.0)</li>';
            html += '<li>k<sub>v</sub> hem (+) hem de (-) durumlarÄ± iÃ§in kontrol edilmelidir</li>';
            html += '<li>Dinamik itki etkime noktasÄ±: H/2 (statikten farklÄ±)</li>';
            html += '<li>Su basÄ±ncÄ± varsa: Î”P<sub>su</sub> = 0.8 Ã— Î³<sub>w</sub> Ã— h<sup>2</sup> Ã— k<sub>h</sub></li>';
            html += '<li>Drenaj sistemi Ã§alÄ±ÅŸmÄ±yorsa dinamik su basÄ±ncÄ± eklenmelidir</li>';
            html += '</ul>';
            html += '</div>';
            
            // Alternatif tasarÄ±m Ã¶nerisi
            if (seismicResults.Delta_P / geoResults.P_h_static > 0.5) {
                html += '<div class="info-box" style="margin-top: 20px;">';
                html += '<h5 style="color: #0c5460;">ğŸ’¡ Alternatif TasarÄ±m Ã–nerisi</h5>';
                html += '<p>Deprem itkisi artÄ±ÅŸÄ± statik itkinin %50\'sini aÅŸÄ±yor.</p>';
                html += '<strong>DeÄŸerlendirilmesi Gereken Alternatifler:</strong>';
                html += '<ul style="margin: 5px 0; padding-left: 20px;">';
                html += '<li><strong>AnkrajlÄ± Ä°stinat DuvarÄ±:</strong> Geri ankrajlarla deprem yÃ¼kÃ¼nÃ¼ azaltÄ±n</li>';
                html += '<li><strong>KazÄ±klÄ± Duvar:</strong> TaÅŸÄ±ma gÃ¼cÃ¼ ve kayma problemlerini Ã§Ã¶zer</li>';
                html += '<li><strong>MSE Duvar:</strong> Geogrid takviyeli zemin, depremde daha esnek</li>';
                html += '<li><strong>Geri BasamaklÄ± Duvar:</strong> Dolgu aÄŸÄ±rlÄ±ÄŸÄ±nÄ± azaltÄ±r</li>';
                html += '</ul>';
                html += '</div>';
            }
            
            document.getElementById('deprem-sonuc').innerHTML = html;
            
            // Stabilite kontrolleri
            const stabilityResults = calculateStability(inputs, geoResults, seismicResults);
            calculationResults.stability = stabilityResults;
            cleanResults(stabilityResults);

            html = '<h4 style="color: #2a5298;">STATÄ°K DURUM KONTROLLERI</h4>';
            html += '<div class="table-container"><table>';
            html += '<tr><th>Kontrol Tipi</th><th>FormÃ¼l</th><th>Hesaplanan GS</th><th>Minimum GS</th><th>Durum</th></tr>';
            
            html += '<tr><td><strong>Devrilme</strong></td><td>GS = Î£M<sub>R</sub> / Î£M<sub>D</sub></td><td>' + stabilityResults.GS_devrilme_static.toFixed(2) + '</td><td>â‰¥ 2.0</td><td>' + (stabilityResults.devrilme_static_ok ? '<span class="result-value success">âœ“ UYGUN</span>' : '<span class="result-value danger">âœ— UYGUN DEÄÄ°L</span>') + '</td></tr>';
            
            html += '<tr><td><strong>Kayma</strong></td><td>GS = Î£F<sub>R</sub> / Î£F<sub>D</sub></td><td>' + stabilityResults.GS_kayma_static.toFixed(2) + '</td><td>â‰¥ 1.5</td><td>' + (stabilityResults.kayma_static_ok ? '<span class="result-value success">âœ“ UYGUN</span>' : '<span class="result-value danger">âœ— UYGUN DEÄÄ°L</span>') + '</td></tr>';
            
            html += '<tr><td><strong>Eksantrisite</strong></td><td>e < B/6</td><td>e = ' + stabilityResults.e_static.toFixed(3) + ' m<br>e/B = ' + stabilityResults.e_B_orani_static.toFixed(3) + '</td><td>< 0.167</td><td>' + (stabilityResults.eksantrisite_static_ok ? '<span class="result-value success">âœ“ UYGUN</span>' : '<span class="result-value danger">âœ— UYGUN DEÄÄ°L</span>') + '</td></tr>';
            
            html += '<tr><td><strong>TaÅŸÄ±ma GÃ¼cÃ¼</strong></td><td>GS = q<sub>ult</sub> / q<sub>max</sub></td><td>' + stabilityResults.GS_tasima_static.toFixed(2) + '<br>q<sub>max</sub> = ' + stabilityResults.q_max_static.toFixed(2) + ' kN/mÂ²</td><td>â‰¥ 2.5</td><td>' + (stabilityResults.tasima_static_ok ? '<span class="result-value success">âœ“ UYGUN</span>' : '<span class="result-value danger">âœ— UYGUN DEÄÄ°L</span>') + '</td></tr>';
            
            html += '</table></div>';
            
            html += '<h4 style="margin-top: 30px; color: #2a5298;">DÄ°NAMÄ°K DURUM KONTROLLERI (TBDY 2018)</h4>';
            html += '<div class="table-container"><table>';
            html += '<tr><th>Kontrol Tipi</th><th>FormÃ¼l</th><th>Hesaplanan GS</th><th>Minimum GS</th><th>Durum</th></tr>';
            
            html += '<tr><td><strong>Devrilme</strong></td><td>GS = Î£M<sub>R</sub> / Î£M<sub>D</sub></td><td>' + stabilityResults.GS_devrilme_dynamic.toFixed(2) + '</td><td>â‰¥ 1.3</td><td>' + (stabilityResults.devrilme_dynamic_ok ? '<span class="result-value success">âœ“ UYGUN</span>' : '<span class="result-value danger">âœ— UYGUN DEÄÄ°L</span>') + '</td></tr>';
            
            html += '<tr><td><strong>Kayma</strong></td><td>GS = Î£F<sub>R</sub> / Î£F<sub>D</sub></td><td>' + stabilityResults.GS_kayma_dynamic.toFixed(2) + '</td><td>â‰¥ 1.1</td><td>' + (stabilityResults.kayma_dynamic_ok ? '<span class="result-value success">âœ“ UYGUN</span>' : '<span class="result-value danger">âœ— UYGUN DEÄÄ°L</span>') + '</td></tr>';
            
            html += '<tr><td><strong>Eksantrisite</strong></td><td>e < B/6</td><td>e = ' + stabilityResults.e_dynamic.toFixed(3) + ' m<br>e/B = ' + stabilityResults.e_B_orani_dynamic.toFixed(3) + '</td><td>< 0.167</td><td>' + (stabilityResults.eksantrisite_dynamic_ok ? '<span class="result-value success">âœ“ UYGUN</span>' : '<span class="result-value danger">âœ— UYGUN DEÄÄ°L</span>') + '</td></tr>';
            
            html += '<tr><td><strong>TaÅŸÄ±ma GÃ¼cÃ¼</strong></td><td>GS = q<sub>ult</sub> / q<sub>max</sub></td><td>' + stabilityResults.GS_tasima_dynamic.toFixed(2) + '<br>q<sub>max</sub> = ' + stabilityResults.q_max_dynamic.toFixed(2) + ' kN/mÂ²</td><td>â‰¥ 1.0</td><td>' + (stabilityResults.tasima_dynamic_ok ? '<span class="result-value success">âœ“ UYGUN</span>' : '<span class="result-value danger">âœ— UYGUN DEÄÄ°L</span>') + '</td></tr>';
            
            html += '</table></div>';
            
            if (stabilityResults.tum_kontroller_ok) {
                html += '<div class="success-box">âœ“ <strong>TÃœM STABÄ°LÄ°TE KONTROLLERI UYGUN</strong> - DÄ±ÅŸ gÃ¼venlik saÄŸlanmÄ±ÅŸtÄ±r.</div>';
            } else {
                html += '<div class="warning-box">âš ï¸ <strong>BAZI KONTROLLERDEN GEÃ‡EMEDÄ°</strong> - Geometrik boyutlar revize edilmelidir.</div>';
                
                // Problem analizi ve Ã§Ã¶zÃ¼m Ã¶nerileri
                html += generateSolutionSuggestions(inputs, stabilityResults, geoResults);
            }
            
            document.getElementById('stabilite-sonuc').innerHTML = html;

            // YapÄ±sal tasarÄ±m
            let structuralResults;
            try {
                structuralResults = calculateStructural(inputs, geoResults, seismicResults, hydResults);
                calculationResults.structural = structuralResults;
                cleanResults(structuralResults);
            } catch (error) {
                console.error('calculateStructural hatasÄ±:', error);
                alert('YapÄ±sal tasarÄ±m hesaplamasÄ±nda hata oluÅŸtu:\n' + error.message);
                document.getElementById('yapisal-sonuc').innerHTML =
                    '<div class="warning-box"><strong>HATA:</strong> ' + error.message + '</div>';
                return; // Fonksiyondan Ã§Ä±k
            }
            
            html = '<div class="info-box"><strong>TS 500 - Betonarme YapÄ±larÄ±n Hesap ve YapÄ±m KurallarÄ±</strong></div>';
            
            html += '<h4 style="color: #2a5298;">Malzeme Ã–zellikleri</h4>';
            html += '<div class="result-item"><span class="result-label">Beton BasÄ±nÃ§ DayanÄ±mÄ± (f<sub>ck</sub>)</span><span class="result-value">' + structuralResults.fck + ' MPa</span></div>';
            html += '<div class="result-item"><span class="result-label">TasarÄ±m BasÄ±nÃ§ DayanÄ±mÄ± (f<sub>cd</sub>)</span><span class="result-value">' + structuralResults.fcd.toFixed(2) + ' MPa</span></div>';
            html += '<div class="result-item"><span class="result-label">TasarÄ±m Ã‡ekme DayanÄ±mÄ± (f<sub>ctd</sub>)</span><span class="result-value">' + structuralResults.fctd.toFixed(2) + ' MPa</span></div>';
            html += '<div class="result-item"><span class="result-label">DonatÄ± Akma DayanÄ±mÄ± (f<sub>yk</sub>)</span><span class="result-value">' + structuralResults.fyk + ' MPa</span></div>';
            html += '<div class="result-item"><span class="result-label">TasarÄ±m Akma DayanÄ±mÄ± (f<sub>yd</sub>)</span><span class="result-value">' + structuralResults.fyd.toFixed(2) + ' MPa</span></div>';
            
            html += '<h4 style="margin-top: 20px; color: #2a5298;">YÃ¼k KombinasyonlarÄ±</h4>';
            html += '<div class="formula-box"><strong>Statik:</strong> V<sub>d</sub> = 1.4G + 1.6H + 1.6Q</div>';
            html += '<div class="result-item"><span class="result-label">TasarÄ±m YÃ¼kÃ¼ (Statik)</span><span class="result-value">' + structuralResults.V_d_static.toFixed(2) + ' kN/m</span></div>';
            html += '<div class="formula-box"><strong>Deprem Durumu:</strong> V<sub>d</sub> = 1.0G + 0.3Q + 1.0E</div>';
            html += '<div class="result-item"><span class="result-label">TasarÄ±m YÃ¼kÃ¼ (Deprem)</span><span class="result-value">' + structuralResults.V_d_earthquake.toFixed(2) + ' kN/m</span></div>';
            html += '<div class="result-item"><span class="result-label"><strong>Maksimum TasarÄ±m YÃ¼kÃ¼</strong></span><span class="result-value success">' + structuralResults.V_d_max.toFixed(2) + ' kN/m</span></div>';
            
            html += '<h4 style="margin-top: 20px; color: #2a5298;">Perde DonatÄ± HesabÄ±</h4>';
            html += '<div class="result-item"><span class="result-label">TasarÄ±m Momenti (M<sub>d</sub>)</span><span class="result-value">' + structuralResults.M_d_perde.toFixed(2) + ' kNm/m</span></div>';
            html += '<div class="result-item"><span class="result-label">Gerekli DonatÄ± AlanÄ± (A<sub>s</sub>)</span><span class="result-value">' + (structuralResults.As_perde_gerekli * 10000).toFixed(2) + ' mmÂ²/m</span></div>';
            html += '<div class="result-item"><span class="result-label">Minimum DonatÄ± (TS 500 Â§12)</span><span class="result-value">' + (structuralResults.As_min_perde * 10000).toFixed(2) + ' mmÂ²/m (0.0025A<sub>g</sub>/2)</span></div>';
            html += '<div class="result-item"><span class="result-label"><strong>TasarÄ±m DonatÄ±sÄ±</strong></span><span class="result-value success">' + (structuralResults.As_perde_tasarim * 10000).toFixed(2) + ' mmÂ²/m</span></div>';
            
            html += '<div class="success-box">';
            html += '<strong>SeÃ§ilen DonatÄ±:</strong><br>';
            html += 'Î¦' + structuralResults.donati_capi + ' / ' + structuralResults.donati_araligi + ' mm<br>';
            html += '(' + structuralResults.donati_adet + ' adet/m, Her iki yÃ¼zde)<br>';
            html += 'Maksimum aralÄ±k: ' + structuralResults.s_max.toFixed(0) + ' mm ' + (structuralResults.aralÄ±k_ok ? 'âœ“' : 'âœ—');
            html += '</div>';
            
            html += '<h4 style="margin-top: 20px; color: #2a5298;">Kesme GÃ¼venliÄŸi</h4>';
            html += '<div class="formula-box"><strong>Beton Kesme DayanÄ±mÄ±:</strong> V<sub>cr</sub> = 0.65 Ã— f<sub>ctd</sub> Ã— b<sub>w</sub> Ã— d</div>';
            html += '<div class="result-item"><span class="result-label">TasarÄ±m Kesme Kuvveti (V<sub>d</sub>)</span><span class="result-value">' + structuralResults.V_d_kesme.toFixed(2) + ' kN</span></div>';
            html += '<div class="result-item"><span class="result-label">Beton Kesme Kapasitesi (V<sub>cr</sub>)</span><span class="result-value">' + structuralResults.V_cr.toFixed(2) + ' kN</span></div>';
            html += '<div class="result-item"><span class="result-label"><strong>Kesme KontrolÃ¼</strong></span><span class="result-value ' + (structuralResults.kesme_ok ? 'success">V<sub>d</sub> â‰¤ V<sub>cr</sub> âœ“ UYGUN' : 'danger">V<sub>d</sub> > V<sub>cr</sub> âœ— UYGUN DEÄÄ°L') + '</span></div>';

            // Kesme DonatÄ±sÄ± (Etriye) - TS 500 Madde 8.5
            html += '<h4 style="margin-top: 20px; color: #2a5298;">Kesme DonatÄ±sÄ± (Etriye) - TS 500 Â§8.5</h4>';
            html += '<div class="formula-box"><strong>Etriye HesabÄ±:</strong> A<sub>sw</sub>/s = (V<sub>d</sub> - V<sub>cr</sub>) / (0.9 Ã— d Ã— f<sub>ywd</sub>)</div>';

            if (structuralResults.kesme_donatisi_gerekli) {
                html += '<div class="result-item"><span class="result-label">TasarÄ±m Kesme Kuvveti (V<sub>d</sub>)</span><span class="result-value">' + structuralResults.V_d_kesme.toFixed(2) + ' kN</span></div>';
                html += '<div class="result-item"><span class="result-label">Beton Kesme Kapasitesi (V<sub>cr</sub>)</span><span class="result-value">' + structuralResults.V_cr.toFixed(2) + ' kN</span></div>';
                html += '<div class="result-item"><span class="result-label">AÅŸÄ±rÄ± Kesme Kuvveti (V<sub>d</sub> - V<sub>cr</sub>)</span><span class="result-value warning">' + (structuralResults.V_d_kesme - structuralResults.V_cr).toFixed(2) + ' kN</span></div>';
                html += '<div class="result-item"><span class="result-label">Gerekli Etriye DonatÄ±sÄ± (A<sub>sw</sub>/s)</span><span class="result-value">' + structuralResults.A_sw_s_required.toFixed(4) + ' mmÂ²/mm = ' + structuralResults.A_sw_s_required_mm2_m.toFixed(2) + ' mmÂ²/m</span></div>';
                html += '<div class="result-item"><span class="result-label">Minimum Etriye</span><span class="result-value">' + (0.3 * inputs.W_alt * 1000 * structuralResults.fctd / structuralResults.fyk).toFixed(2) + ' mmÂ²/m</span></div>';
                html += '<div class="success-box"><strong>Ã–nerilen Etriye:</strong><br>' + structuralResults.stirrup_recommendation + '</div>';
                html += '<div class="info-box"><strong>Maksimum Etriye AralÄ±ÄŸÄ± (TS 500 Â§8.5.3):</strong><br>s<sub>max</sub> = min(0.75d, 300mm) = ' + structuralResults.stirrup_spacing_max.toFixed(0) + ' mm</div>';
            } else {
                html += '<div class="success-box"><strong>âœ“ Etriye Gerekli DeÄŸil</strong><br>Beton kesme kapasitesi yeterli (V<sub>d</sub> â‰¤ V<sub>cr</sub>)<br>Uygulamada minimum donatÄ± (Î¦8 @200-250mm) tavsiye edilebilir.</div>';
            }

            // YapÄ±sal problemler iÃ§in Ã§Ã¶zÃ¼m Ã¶nerileri
            if (!structuralResults.kesme_ok || !structuralResults.aralÄ±k_ok) {
                html += generateStructuralSolutions(inputs, structuralResults);
            }
            
            document.getElementById('yapisal-sonuc').innerHTML = html;
            
            // Metraj hesaplarÄ±
            const metrajResults = calculateMetraj(inputs);
            calculationResults.metraj = metrajResults;
            cleanResults(metrajResults);
            
            html = '<h4 style="color: #2a5298;">Beton MetrajÄ±</h4>';
            html += '<div class="table-container"><table>';
            html += '<tr><th>YapÄ± ElemanÄ±</th><th>Boyutlar</th><th>FormÃ¼l</th><th>Hacim (mÂ³)</th></tr>';
            html += '<tr><td><strong>Temel PlaÄŸÄ±</strong></td><td>' + inputs.L + ' Ã— ' + inputs.B + ' Ã— ' + inputs.TH + '</td><td>L Ã— B Ã— T<sub>H</sub></td><td>' + metrajResults.V_temel.toFixed(2) + '</td></tr>';
            html += '<tr><td><strong>Perde DuvarÄ±</strong></td><td>' + inputs.L + ' Ã— ' + ((inputs.W_alt + inputs.W_ust) / 2).toFixed(2) + ' Ã— ' + (inputs.H - inputs.TH).toFixed(2) + '</td><td>L Ã— W<sub>ort</sub> Ã— H<sub>perde</sub></td><td>' + metrajResults.V_perde.toFixed(2) + '</td></tr>';
            html += '<tr style="background: #f0f0f0;"><td><strong>TOPLAM C30 BETON</strong></td><td colspan="2"></td><td><strong>' + metrajResults.V_beton_toplam.toFixed(2) + '</strong></td></tr>';
            html += '<tr><td><strong>Grobeton</strong></td><td>' + inputs.L + ' Ã— ' + inputs.B + ' Ã— 0.10</td><td>L Ã— B Ã— 0.10</td><td>' + metrajResults.V_grobeton.toFixed(2) + '</td></tr>';
            html += '</table></div>';
            
            html += '<h4 style="margin-top: 30px; color: #2a5298;">KalÄ±p MetrajÄ±</h4>';
            html += '<div class="table-container"><table>';
            html += '<tr><th>KalÄ±p TÃ¼rÃ¼</th><th>Hesaplama</th><th>Alan (mÂ²)</th></tr>';
            html += '<tr><td><strong>Temel KalÄ±bÄ±</strong></td><td>2Ã—(LÃ—T<sub>H</sub> + BÃ—T<sub>H</sub>)</td><td>' + metrajResults.A_kalip_temel.toFixed(2) + '</td></tr>';
            html += '<tr><td><strong>Perde KalÄ±bÄ±</strong></td><td>2 Ã— L Ã— H<sub>perde</sub></td><td>' + metrajResults.A_kalip_perde.toFixed(2) + '</td></tr>';
            html += '<tr style="background: #f0f0f0;"><td><strong>TOPLAM KALIP</strong></td><td></td><td><strong>' + metrajResults.A_kalip_toplam.toFixed(2) + '</strong></td></tr>';
            html += '</table></div>';
            
            html += '<h4 style="margin-top: 30px; color: #2a5298;">DonatÄ± MetrajÄ±</h4>';
            html += '<div class="table-container"><table>';
            html += '<tr><th>DonatÄ± TÃ¼rÃ¼</th><th>Uzunluk (m)</th><th>AÄŸÄ±rlÄ±k (ton)</th></tr>';
            html += '<tr><td><strong>DÃ¼ÅŸey DonatÄ± (Perde)</strong></td><td>' + metrajResults.L_donati_dusey.toFixed(2) + '</td><td>' + (metrajResults.L_donati_dusey * 1.578 / 1000).toFixed(3) + '</td></tr>';
            html += '<tr><td><strong>Yatay DonatÄ± (Perde)</strong></td><td>' + metrajResults.L_donati_yatay.toFixed(2) + '</td><td>' + (metrajResults.L_donati_yatay * 1.578 / 1000).toFixed(3) + '</td></tr>';
            html += '<tr><td><strong>Temel DonatÄ±sÄ±</strong></td><td>' + metrajResults.L_donati_temel.toFixed(2) + '</td><td>' + (metrajResults.L_donati_temel * 1.578 / 1000).toFixed(3) + '</td></tr>';
            html += '<tr style="background: #f0f0f0;"><td><strong>TOPLAM DONATI (Î¦16)</strong></td><td><strong>' + metrajResults.L_donati_toplam.toFixed(2) + '</strong></td><td><strong>' + metrajResults.W_donati.toFixed(3) + '</strong></td></tr>';
            html += '</table></div>';
            
            html += '<div class="info-box" style="margin-top: 20px;">';
            html += '<strong>Metraj Ã–zeti:</strong><br>';
            html += 'â€¢ C30 Beton: ' + metrajResults.V_beton_toplam.toFixed(2) + ' mÂ³<br>';
            html += 'â€¢ Grobeton: ' + metrajResults.V_grobeton.toFixed(2) + ' mÂ³<br>';
            html += 'â€¢ KalÄ±p: ' + metrajResults.A_kalip_toplam.toFixed(2) + ' mÂ²<br>';
            html += 'â€¢ DonatÄ±: ' + metrajResults.W_donati.toFixed(3) + ' ton (Î¦16 B420C)';
            html += '</div>';
            
            document.getElementById('metraj-sonuc').innerHTML = html;

            // Tam rapor
            generateFullReport();
        }

        function generateFullReport() {
            const inputs = getInputValues();
            
            let html = '<div style="max-width: 900px; margin: 0 auto;">';
            
            html += '<div style="text-align: center; margin-bottom: 30px;">';
            html += '<h2 style="color: #1e3c72;">BETONARME U-KANAL TEKNÄ°K HESAP RAPORU</h2>';
            html += '<p style="color: #666;">TBDY 2018 & TS 500 UyarÄ±nca</p>';
            html += '<p style="color: #666;">Tarih: ' + new Date().toLocaleDateString('tr-TR') + '</p>';
            html += '</div>';
            
            // 1. Proje Bilgileri
            html += '<div class="form-section">';
            html += '<h3>1. PROJE BÄ°LGÄ°LERÄ° VE GÄ°RÄ°Å VERÄ°LERÄ°</h3>';
            html += '<div class="table-container"><table>';
            html += '<tr><th colspan="2" style="background: #2a5298; color: white;">Hidrolik Parametreler</th></tr>';
            html += '<tr><td>TasarÄ±m TaÅŸkÄ±n Debisi (Q<sub>T</sub>)</td><td>' + inputs.Q_T + ' mÂ³/sn</td></tr>';
            html += '<tr><td>Kanal GeniÅŸliÄŸi (b)</td><td>' + inputs.b + ' m</td></tr>';
            html += '<tr><td>Manning KatsayÄ±sÄ± (n)</td><td>' + inputs.n + '</td></tr>';
            html += '<tr><td>Kanal EÄŸimi (S<sub>o</sub>)</td><td>' + inputs.So + '</td></tr>';
            html += '<tr><th colspan="2" style="background: #2a5298; color: white;">Geometrik Parametreler</th></tr>';
            html += '<tr><td>Toplam Duvar YÃ¼ksekliÄŸi (H)</td><td>' + inputs.H + ' m</td></tr>';
            html += '<tr><td>Temel GeniÅŸliÄŸi (B)</td><td>' + inputs.B + ' m</td></tr>';
            html += '<tr><td>Temel KalÄ±nlÄ±ÄŸÄ± (T<sub>H</sub>)</td><td>' + inputs.TH + ' m</td></tr>';
            html += '<tr><td>Duvar UzunluÄŸu (L)</td><td>' + inputs.L + ' m</td></tr>';
            html += '<tr><th colspan="2" style="background: #2a5298; color: white;">Zemin Parametreleri</th></tr>';
            html += '<tr><td>Zemin Birim Hacim AÄŸÄ±rlÄ±ÄŸÄ± (Î³)</td><td>' + inputs.gamma_zemin + ' kN/mÂ³</td></tr>';
            html += '<tr><td>Ä°Ã§sel SÃ¼rtÃ¼nme AÃ§Ä±sÄ± (Ï†)</td><td>' + inputs.phi + 'Â°</td></tr>';
            html += '<tr><td>Kohezyon (c)</td><td>' + inputs.c + ' kPa</td></tr>';
            html += '<tr><td>Zemin TaÅŸÄ±ma GÃ¼cÃ¼ (q<sub>ult</sub>)</td><td>' + inputs.q_ult + ' kN/mÂ²</td></tr>';
            html += '<tr><th colspan="2" style="background: #2a5298; color: white;">Deprem Parametreleri</th></tr>';
            html += '<tr><td>S<sub>DS</sub></td><td>' + inputs.SDS + ' g</td></tr>';
            html += '<tr><td>Azaltma KatsayÄ±sÄ± (r)</td><td>' + inputs.r + '</td></tr>';
            html += '</table></div>';
            html += '</div>';
            
            // TÃ¼m sonuÃ§larÄ± Ã¶zet olarak ekle
            if (calculationResults.hydraulics) {
                html += '<div class="form-section">';
                html += '<h3>2. HÄ°DROLÄ°K HESAPLAMALAR</h3>';
                html += document.getElementById('hidrolik-sonuc').innerHTML;
                html += '</div>';
            }
            
            if (calculationResults.geotechnics) {
                html += '<div class="form-section">';
                html += '<h3>3. GEOTEKNÄ°K ANALÄ°Z</h3>';
                html += document.getElementById('geoteknik-sonuc').innerHTML;
                html += '</div>';
            }
            
            if (calculationResults.seismic) {
                html += '<div class="form-section">';
                html += '<h3>4. DEPREM ETKÄ°SÄ° (TBDY 2018)</h3>';
                html += document.getElementById('deprem-sonuc').innerHTML;
                html += '</div>';
            }
            
            if (calculationResults.stability) {
                html += '<div class="form-section">';
                html += '<h3>5. STABÄ°LÄ°TE KONTROLLERI</h3>';
                html += document.getElementById('stabilite-sonuc').innerHTML;
                html += '</div>';
            }
            
            if (calculationResults.structural) {
                html += '<div class="form-section">';
                html += '<h3>6. YAPISAL TASARIM (TS 500)</h3>';
                html += document.getElementById('yapisal-sonuc').innerHTML;
                html += '</div>';
            }
            
            if (calculationResults.metraj) {
                html += '<div class="form-section">';
                html += '<h3>7. METRAJ HESAPLARI</h3>';
                html += document.getElementById('metraj-sonuc').innerHTML;
                html += '</div>';
            }
            
            // SonuÃ§ ve Ã–neriler
            html += '<div class="form-section">';
            html += '<h3>8. SONUÃ‡ VE Ã–NERÄ°LER</h3>';
            
            if (calculationResults.stability && calculationResults.stability.tum_kontroller_ok) {
                html += '<div class="success-box">';
                html += '<h4>âœ“ TASARIM UYGUN</h4>';
                html += '<p>YapÄ±lan hesaplamalar sonucunda, tasarlanan betonarme U-kanal yapÄ±sÄ±:</p>';
                html += '<ul>';
                html += '<li>Hidrolik olarak tasarÄ±m debisini gÃ¼venle taÅŸÄ±maktadÄ±r</li>';
                html += '<li>TÃ¼m stabilite kontrollerini saÄŸlamaktadÄ±r (devrilme, kayma, taÅŸÄ±ma gÃ¼cÃ¼)</li>';
                html += '<li>TBDY 2018 deprem yÃ¶netmeliÄŸi ÅŸartlarÄ±nÄ± karÅŸÄ±lamaktadÄ±r</li>';
                html += '<li>TS 500 betonarme yÃ¶netmeliÄŸine uygun donatÄ± tasarlanmÄ±ÅŸtÄ±r</li>';
                html += '</ul>';
                html += '</div>';
            } else {
                html += '<div class="warning-box">';
                html += '<h4>âš ï¸ REVÄ°ZYON GEREKLÄ°</h4>';
                html += '<p>BazÄ± kontroller saÄŸlanamamÄ±ÅŸtÄ±r. Geometrik boyutlarÄ±n revize edilmesi Ã¶nerilir.</p>';
                html += '</div>';
            }
            
            html += '<div class="info-box">';
            html += '<h4>Ã–nemli Notlar:</h4>';
            html += '<ul>';
            html += '<li><strong>Drenaj Sistemi:</strong> Duvar arkasÄ±nda hidrostatik basÄ±nÃ§ oluÅŸmamasÄ± iÃ§in etkin drenaj sistemi (barbakanlar, drenaj borularÄ±, geotekstil) mutlaka uygulanmalÄ±dÄ±r.</li>';
            html += '<li><strong>Geri Dolgu:</strong> Ä°yi derecelenmiÅŸ, kohezyonsuz malzeme (GW, SW, GP, SP) kullanÄ±lmalÄ±dÄ±r. ÅiÅŸen killer (CH, OH) kesinlikle kullanÄ±lmamalÄ±dÄ±r.</li>';
            html += '<li><strong>Temel DerinliÄŸi:</strong> Temel, don derinliÄŸinin altÄ±na inmelidir.</li>';
            html += '<li><strong>Derzler:</strong> 7-10 m aralÄ±klarla dÃ¼ÅŸey derzler bÄ±rakÄ±lmalÄ±dÄ±r.</li>';
            html += '<li><strong>SÄ±kÄ±ÅŸtÄ±rma:</strong> Dolgu aÅŸÄ±rÄ± sÄ±kÄ±ÅŸtÄ±rÄ±lmamalÄ±dÄ±r.</li>';
            html += '<li><strong>Beton Kalitesi:</strong> Minimum C25/30, Ã¶nerilen C30/37</li>';
            html += '<li><strong>DonatÄ±:</strong> B420C veya B500C, minimum Ã¶rtÃ¼ 4 cm</li>';
            html += '</ul>';
            html += '</div>';
            html += '</div>';
            
            // Ä°mza kÄ±smÄ±
            html += '<div style="margin-top: 50px; display: flex; justify-content: space-around;">';
            html += '<div style="text-align: center;">';
            html += '<div style="border-top: 2px solid #333; width: 200px; margin-top: 50px;"></div>';
            html += '<p><strong>Hesaplayan MÃ¼hendis</strong></p>';
            html += '</div>';
            html += '<div style="text-align: center;">';
            html += '<div style="border-top: 2px solid #333; width: 200px; margin-top: 50px;"></div>';
            html += '<p><strong>Kontrol Eden MÃ¼hendis</strong></p>';
            html += '</div>';
            html += '</div>';
            
            html += '</div>';
            
            document.getElementById('rapor-sonuc').innerHTML = html;
        }

        function calculateAll() {
            displayResults();
            // Ä°lk sonuÃ§ sekmesine geÃ§
            const tabs = document.getElementsByClassName('tab');
            const tabContents = document.getElementsByClassName('tab-content');
            
            for (let i = 0; i < tabContents.length; i++) {
                tabContents[i].classList.remove('active');
            }
            for (let i = 0; i < tabs.length; i++) {
                tabs[i].classList.remove('active');
            }
            
            document.getElementById('hidrolik').classList.add('active');
            tabs[1].classList.add('active');
            
            // BaÅŸarÄ± mesajÄ± gÃ¶ster
            alert('âœ“ Hesaplamalar tamamlandÄ±! SonuÃ§larÄ± inceleyin.');
        }

        function resetForm() {
            if (confirm('TÃ¼m verileri sÄ±fÄ±rlamak istediÄŸinizden emin misiniz?')) {
                location.reload();
            }
        }

        function quickOptimize() {
            if (!confirm('ğŸ”§ HIZLI OPTÄ°MÄ°ZASYON\n\n' +
                        'Bu fonksiyon, tasarÄ±mÄ± otomatik olarak optimize edecektir:\n\n' +
                        'âœ“ Stabilite problemlerini Ã§Ã¶zmek iÃ§in temel geniÅŸliÄŸini ayarlar\n' +
                        'âœ“ YapÄ±sal problemleri gidermek iÃ§in kesit boyutlarÄ±nÄ± optimize eder\n' +
                        'âœ“ Hidrolik parametreleri kontrol eder\n\n' +
                        'Devam etmek istiyor musunuz?')) {
                return;
            }
            
            const inputs = getInputValues();
            let optimizationLog = 'ğŸ“‹ OPTÄ°MÄ°ZASYON RAPORU\n\n';
            let changesMade = false;
            
            // Ä°lk hesaplamayÄ± yap
            const hydResults = calculateHydraulics(inputs);
            const geoResults = calculateGeotechnics(inputs);
            const seismicResults = calculateSeismic(inputs, geoResults);
            const stabilityResults = calculateStability(inputs, geoResults, seismicResults);
            const structuralResults = calculateStructural(inputs, geoResults, seismicResults, hydResults);
            
            // 1. Stabilite optimizasyonu
            if (!stabilityResults.devrilme_static_ok || !stabilityResults.devrilme_dynamic_ok ||
                !stabilityResults.kayma_static_ok || !stabilityResults.kayma_dynamic_ok ||
                !stabilityResults.tasima_static_ok) {
                
                // Temel geniÅŸliÄŸini artÄ±r
                let B_new = inputs.B;
                
                if (!stabilityResults.devrilme_static_ok) {
                    const factor = 2.0 / stabilityResults.GS_devrilme_static;
                    B_new = Math.max(B_new, inputs.B * Math.pow(factor, 0.4));
                    optimizationLog += 'ğŸ”§ Devrilme (Statik): GS=' + stabilityResults.GS_devrilme_static.toFixed(2) + ' â†’ Temel geniÅŸliÄŸi artÄ±rÄ±lmalÄ±\n';
                }
                
                if (!stabilityResults.devrilme_dynamic_ok) {
                    const factor = 1.3 / stabilityResults.GS_devrilme_dynamic;
                    B_new = Math.max(B_new, inputs.B * Math.pow(factor, 0.4));
                    optimizationLog += 'ğŸ”§ Devrilme (Dinamik): GS=' + stabilityResults.GS_devrilme_dynamic.toFixed(2) + ' â†’ Temel geniÅŸliÄŸi artÄ±rÄ±lmalÄ±\n';
                }
                
                if (!stabilityResults.kayma_static_ok || !stabilityResults.kayma_dynamic_ok) {
                    optimizationLog += 'ğŸ”§ Kayma problemi: Temel diÅŸi (shear key) eklenmesi ÅÄ°DDETLE Ã–NERÄ°LÄ°R!\n';
                    B_new = Math.max(B_new, inputs.B * 1.1);
                }
                
                if (!stabilityResults.tasima_static_ok) {
                    const factor = 2.5 / stabilityResults.GS_tasima_static;
                    B_new = Math.max(B_new, inputs.B * Math.pow(factor, 0.5));
                    optimizationLog += 'ğŸ”§ TaÅŸÄ±ma GÃ¼cÃ¼: GS=' + stabilityResults.GS_tasima_static.toFixed(2) + ' â†’ Temel geniÅŸliÄŸi artÄ±rÄ±lmalÄ±\n';
                }
                
                if (B_new > inputs.B) {
                    document.getElementById('B').value = B_new.toFixed(2);
                    optimizationLog += '\nâœ… Temel geniÅŸliÄŸi: ' + inputs.B.toFixed(2) + ' m â†’ ' + B_new.toFixed(2) + ' m\n\n';
                    changesMade = true;
                }
            }
            
            // 2. YapÄ±sal optimizasyon
            if (!structuralResults.kesme_ok) {
                const W_new = inputs.W_alt * Math.sqrt(structuralResults.V_d_kesme / structuralResults.V_cr);
                document.getElementById('W_alt').value = W_new.toFixed(2);
                
                const W_ust_new = Math.max(0.3, inputs.W_ust * (W_new / inputs.W_alt));
                document.getElementById('W_ust').value = W_ust_new.toFixed(2);
                
                optimizationLog += 'ğŸ”§ Kesme Kapasitesi Yetersiz\n';
                optimizationLog += 'âœ… Perde alt kalÄ±nlÄ±ÄŸÄ±: ' + inputs.W_alt.toFixed(2) + ' m â†’ ' + W_new.toFixed(2) + ' m\n';
                optimizationLog += 'âœ… Perde Ã¼st kalÄ±nlÄ±ÄŸÄ±: ' + inputs.W_ust.toFixed(2) + ' m â†’ ' + W_ust_new.toFixed(2) + ' m\n\n';
                changesMade = true;
            }
            
            // 3. Hidrolik kontroller
            if (hydResults.Fr > 1.2) {
                optimizationLog += 'âš ï¸ Hidrolik: YÃ¼ksek hÄ±zlÄ± akÄ±m (Fr=' + hydResults.Fr.toFixed(2) + ')\n';
                optimizationLog += '   â†’ Kanal geniÅŸliÄŸini artÄ±rÄ±n veya eÄŸimi azaltÄ±n\n';
                optimizationLog += '   â†’ Enerji kÄ±rÄ±cÄ± yapÄ±lar dÃ¼ÅŸÃ¼nÃ¼n\n\n';
            }
            
            if (hydResults.H_p < 0.5) {
                optimizationLog += 'ğŸ’¡ Hidrolik: Hava payÄ± ' + hydResults.H_p.toFixed(2) + ' m < 0.50 m (yetersiz)\n';
                optimizationLog += '   â†’ Meskun mahalde minimum 0.50 m Ã¶nerilir\n\n';
            }
            
            // 4. Zemin uyarÄ±larÄ±
            if (inputs.phi < 28) {
                optimizationLog += 'âš ï¸ Zemin: DÃ¼ÅŸÃ¼k sÃ¼rtÃ¼nme aÃ§Ä±sÄ± (Ï†=' + inputs.phi + 'Â°)\n';
                optimizationLog += '   â†’ Daha iyi drenajlÄ± geri dolgu kullanÄ±n (Ï†>32Â°)\n';
                optimizationLog += '   â†’ Geogrid takviye dÃ¼ÅŸÃ¼nÃ¼n\n\n';
            }
            
            // 5. Deprem uyarÄ±larÄ±
            if (seismicResults.k_h > 0.25) {
                optimizationLog += 'ğŸŒŠ Deprem: YÃ¼ksek sismik yÃ¼k (k_h=' + seismicResults.k_h.toFixed(3) + ')\n';
                optimizationLog += '   â†’ Temel diÅŸi mutlaka ekleyin\n';
                optimizationLog += '   â†’ Etkin drenaj sistemi kritik\n';
                optimizationLog += '   â†’ Hafif geri dolgu malzemesi kullanÄ±n\n\n';
            }
            
            // SonuÃ§ mesajÄ±
            if (changesMade) {
                optimizationLog += 'â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•\n';
                optimizationLog += 'âœ… OPTÄ°MÄ°ZASYON TAMAMLANDI\n\n';
                optimizationLog += 'DeÄŸiÅŸiklikler uygulandÄ±!\n';
                optimizationLog += 'Åimdi "TÃ¼m HesaplamalarÄ± Yap" butonuna tÄ±klayÄ±n.\n';
                
                alert(optimizationLog);
                
                // Otomatik hesaplama yap
                if (confirm('Otomatik olarak yeni hesaplamayÄ± baÅŸlatalÄ±m mÄ±?')) {
                    calculateAll();
                }
            } else {
                optimizationLog += 'â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•\n';
                optimizationLog += 'âœ… TASARIM ZATEN OPTÄ°MAL\n\n';
                optimizationLog += 'Geometrik deÄŸiÅŸiklik gerekmemektedir.\n';
                
                if (optimizationLog.includes('âš ï¸') || optimizationLog.includes('ğŸ’¡')) {
                    optimizationLog += '\nAncak yukarÄ±daki Ã¶nerileri dikkate alÄ±n.';
                }
                
                alert(optimizationLog);
            }
        }

        function resetForm() {
            if (confirm('TÃ¼m verileri sÄ±fÄ±rlamak istediÄŸinizden emin misiniz?')) {
                location.reload();
            }
        }

        function printReport() {
            window.print();
        }

        function exportToExcel() {
            alert('Excel export fonksiyonu yakÄ±nda eklenecek!');
        }

        function saveCurrentDesign() {
            if (!calculationResults.stability) {
                alert('âš ï¸ Ã–nce hesaplama yapmalÄ±sÄ±nÄ±z!');
                return;
            }
            
            savedDesign = {
                inputs: getInputValues(),
                results: JSON.parse(JSON.stringify(calculationResults)),
                timestamp: new Date().toLocaleString('tr-TR')
            };
            
            alert('âœ… Mevcut tasarÄ±m kaydedildi!\n\n' +
                  'Åimdi parametreleri deÄŸiÅŸtirebilir ve\n' +
                  '"TasarÄ±mlarÄ± KarÅŸÄ±laÅŸtÄ±r" ile farkÄ± gÃ¶rebilirsiniz.');
        }

        function compareDesigns() {
            if (!savedDesign) {
                alert('âš ï¸ Ã–nce bir tasarÄ±m kaydetmelisiniz!\n\n' +
                      '1. Ä°lk tasarÄ±mÄ± hesaplayÄ±n\n' +
                      '2. "TasarÄ±mÄ± Kaydet" butonuna tÄ±klayÄ±n\n' +
                      '3. Parametreleri deÄŸiÅŸtirin\n' +
                      '4. Tekrar hesaplayÄ±n\n' +
                      '5. "TasarÄ±mlarÄ± KarÅŸÄ±laÅŸtÄ±r" ile farkÄ± gÃ¶rÃ¼n');
                return;
            }
            
            if (!calculationResults.stability) {
                alert('âš ï¸ Yeni tasarÄ±m iÃ§in hesaplama yapmalÄ±sÄ±nÄ±z!');
                return;
            }
            
            const current = {
                inputs: getInputValues(),
                results: calculationResults
            };
            
            let html = '<div class="results-section" style="margin-top: 30px;">';
            html += '<h3>ğŸ“Š TASARIM KARÅILAÅTIRMASI</h3>';
            html += '<p style="color: #666; margin-bottom: 20px;">Kaydedilen TasarÄ±m: ' + savedDesign.timestamp + '</p>';
            
            // Geometrik parametreler
            html += '<h4 style="color: #2a5298; margin-top: 20px;">Geometrik Parametreler</h4>';
            html += '<div class="table-container"><table>';
            html += '<tr><th>Parametre</th><th>Eski</th><th>Yeni</th><th>DeÄŸiÅŸim</th></tr>';
            
            const params = [
                ['Temel GeniÅŸliÄŸi', 'B', 'm'],
                ['Temel KalÄ±nlÄ±ÄŸÄ±', 'TH', 'm'],
                ['Perde Alt KalÄ±nlÄ±ÄŸÄ±', 'W_alt', 'm'],
                ['Duvar YÃ¼ksekliÄŸi', 'H', 'm']
            ];
            
            params.forEach(([label, key, unit]) => {
                const oldVal = savedDesign.inputs[key];
                const newVal = current.inputs[key];
                const change = newVal - oldVal;
                const changePercent = ((change / oldVal) * 100).toFixed(1);
                const changeColor = change > 0 ? '#dc3545' : change < 0 ? '#28a745' : '#666';
                const arrow = change > 0 ? 'â†‘' : change < 0 ? 'â†“' : 'â†’';
                
                html += '<tr><td>' + label + '</td><td>' + oldVal.toFixed(2) + ' ' + unit + '</td><td>' + 
                       newVal.toFixed(2) + ' ' + unit + '</td><td style="color: ' + changeColor + '; font-weight: bold;">' +
                       arrow + ' ' + Math.abs(change).toFixed(2) + ' ' + unit + ' (' + changePercent + '%)</td></tr>';
            });
            
            html += '</table></div>';
            
            // Stabilite
            html += '<h4 style="color: #2a5298; margin-top: 20px;">GÃ¼venlik SayÄ±larÄ±</h4>';
            html += '<div class="table-container"><table>';
            html += '<tr><th>Kontrol</th><th>Eski</th><th>Yeni</th><th>Min</th><th>Durum</th></tr>';
            
            const stabilities = [
                ['Devrilme (Statik)', 'GS_devrilme_static', 2.0],
                ['Kayma (Statik)', 'GS_kayma_static', 1.5],
                ['TaÅŸÄ±ma (Statik)', 'GS_tasima_static', 2.5],
                ['Devrilme (Dinamik)', 'GS_devrilme_dynamic', 1.3],
                ['Kayma (Dinamik)', 'GS_kayma_dynamic', 1.1]
            ];
            
            stabilities.forEach(([label, key, minVal]) => {
                const oldVal = savedDesign.results.stability[key];
                const newVal = current.results.stability[key];
                const oldOk = oldVal >= minVal;
                const newOk = newVal >= minVal;
                
                let status = '';
                if (!oldOk && newOk) status = '<span style="color: #28a745;">âœ“ Ä°YÄ°LEÅTÄ°</span>';
                else if (oldOk && !newOk) status = '<span style="color: #dc3545;">âœ— KÃ–TÃœLEÅTI</span>';
                else if (newVal > oldVal) status = '<span style="color: #28a745;">â†‘</span>';
                else if (newVal < oldVal) status = '<span style="color: #ffc107;">â†“</span>';
                else status = '<span style="color: #666;">â†’</span>';
                
                html += '<tr><td>' + label + '</td><td>' + oldVal.toFixed(2) + '</td><td><strong>' + 
                       newVal.toFixed(2) + '</strong></td><td>' + minVal.toFixed(1) + '</td><td>' + status + '</td></tr>';
            });
            
            html += '</table></div>';
            
            // Maliyet
            html += '<h4 style="color: #2a5298; margin-top: 20px;">Maliyet Analizi</h4>';
            html += '<div class="table-container"><table>';
            html += '<tr><th>Kalem</th><th>Eski</th><th>Yeni</th><th>Fark (%)</th></tr>';
            
            const metrajItems = [
                ['Beton C30', 'V_beton_toplam', 'mÂ³'],
                ['KalÄ±p', 'A_kalip_toplam', 'mÂ²'],
                ['DonatÄ±', 'W_donati', 'ton']
            ];
            
            metrajItems.forEach(([label, key, unit]) => {
                const oldVal = savedDesign.results.metraj[key];
                const newVal = current.results.metraj[key];
                const fark = newVal - oldVal;
                const farkPercent = ((fark / oldVal) * 100).toFixed(1);
                const color = fark > 0 ? '#dc3545' : '#28a745';
                
                html += '<tr><td>' + label + '</td><td>' + oldVal.toFixed(2) + ' ' + unit + '</td><td>' + 
                       newVal.toFixed(2) + ' ' + unit + '</td><td style="color: ' + color + ';"><strong>' + 
                       (fark > 0 ? '+' : '') + fark.toFixed(2) + ' (' + farkPercent + '%)</strong></td></tr>';
            });
            
            html += '</table></div>';
            
            html += '</div>';
            
            document.getElementById('comparison-area').innerHTML = html;
            document.getElementById('comparison-area').scrollIntoView({ behavior: 'smooth' });
        }

        function exportToExcel() {
            alert('Excel export fonksiyonu yakÄ±nda eklenecek!');
        }

        // Sayfa yÃ¼klendiÄŸinde Ã¶rnek hesaplama
        window.onload = function() {
            console.log('Betonarme U-Kanal TasarÄ±m UygulamasÄ± hazÄ±r!');
        };
    </script>
</body>
</html>